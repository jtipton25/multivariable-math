{
  "hash": "efa6a0b087179468c807c288782fe59a",
  "result": {
    "markdown": "# Block Matrices {#block-matrices}\n\n\nAnother way to represent matrices is using a block (or partitioned) form. A block-representation of a matrix arises when the $n \\times p$ matrix $\\mathbf{A}$ is represented using smaller blocks as follows:\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} & = \\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} & \\cdots & \\mathbf{A}_{1K} \\\\\n\\mathbf{A}_{21} & \\mathbf{A}_{22} &  \\cdots & \\mathbf{A}_{2K} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{A}_{J1} & \\mathbf{A}_{J2} & \\cdots & \\mathbf{A}_{JK} \\\\\n\\end{pmatrix} \\\\\n\\end{aligned}\n$$\n\n\n\nwhere $\\mathbf{A}_{ij}$ is a $n_j \\times p_k$ matrix where $\\sum_{j=1}^J n_j = n$ and $\\sum_{k=1}^K p_k = p$.\n\nFor example, the matrix\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} & = \\begin{pmatrix} 5 & 7 & 1 \\\\\n5 & -22  & 2 \\\\\n-14 & 5 & 99 \\\\\n42 & -3 & 0\\end{pmatrix},\n\\end{aligned}\n$$\n\n\n\ncan be written in block matrix form with\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} & =\n\\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} \\\\\n\\mathbf{A}_{21} & \\mathbf{A}_{22} \\end{pmatrix} \\\\\n& = \\begin{pmatrix} \\begin{bmatrix} 5 & 7 \\\\\n5 & -22 \\end{bmatrix} &\n\\begin{bmatrix} 1 \\\\\n2 \\end{bmatrix} \\\\\n\\begin{bmatrix}\n-14 & 5 \\\\\n42 & -3\n\\end{bmatrix} &\n\\begin{bmatrix} 99 \\\\ 0 \\end{bmatrix}\n\\end{pmatrix},\n\\end{aligned}\n$$\n\n\n\nwhere $\\mathbf{A}_{11} = \\begin{bmatrix} 5 & 7 \\\\ 5 & -22 \\end{bmatrix}$ is a $2 \\times 2$ matrix,  $\\mathbf{A}_{12} = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}$ is a $2 \\times 1$ matrix, etc.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA_11 <- matrix(c(5, 5, 7, -22), 2, 2)\nA_12 <- c(1, 2)\nA_21 <- matrix(c(-14, 42, 5, -3), 2, 2)\nA_22 <- c(99, 0)\n\n## bind columns then rows\nrbind(\n    cbind(A_11, A_12),\n    cbind(A_21, A_22)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             A_12\n[1,]   5   7    1\n[2,]   5 -22    2\n[3,] -14   5   99\n[4,]  42  -3    0\n```\n:::\n\n```{.r .cell-code}\n## bind rows then columns\ncbind(\n    rbind(A_11, A_21),\n    c(A_12, A_22) ## rbind on vectors is different than c()\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    5    7    1\n[2,]    5  -22    2\n[3,]  -14    5   99\n[4,]   42   -3    0\n```\n:::\n\n```{.r .cell-code}\n## bind rows then columns\ncbind(\n    rbind(A_11, A_21),\n    ## convert the vectors to matrices for rbind\n    rbind(as.matrix(A_12), as.matrix(A_22))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    5    7    1\n[2,]    5  -22    2\n[3,]  -14    5   99\n[4,]   42   -3    0\n```\n:::\n:::\n\n\n\n## Block Matrix Addition\n\nIf $\\mathbf{A}$ and $\\mathbf{B}$ are both $m \\times n$ block matrices with blocks in $r$ rows and $c$ columns where\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} & =\n\\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} & \\cdots & \\mathbf{A}_{1c}\\\\\n\\mathbf{A}_{21} & \\mathbf{A}_{22} &\\cdots & \\mathbf{A}_{2c} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{A}_{r1} & \\mathbf{A}_{r2} &\\cdots & \\mathbf{A}_{rc} \\\\\n\\end{pmatrix} &\n\\mathbf{B} & =\n\\begin{pmatrix} \\mathbf{B}_{11} & \\mathbf{B}_{12} & \\cdots & \\mathbf{B}_{1c}\\\\\n\\mathbf{B}_{21} & \\mathbf{B}_{22} &\\cdots & \\mathbf{B}_{2c} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{B}_{r1} & \\mathbf{B}_{r2} &\\cdots & \\mathbf{B}_{rc} \\\\\n\\end{pmatrix} \\\\\n\\end{aligned}\n$$\n\n\nand each block $\\mathbf{A}_{ij}$ and $\\mathbf{B}_{ij}$ have the same dimension, then \n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} + \\mathbf{B} & =\n\\begin{pmatrix} \\mathbf{A}_{11} + \\mathbf{B}_{11} & \\mathbf{A}_{12} + \\mathbf{B}_{12} & \\cdots & \\mathbf{A}_{1c} + \\mathbf{B}_{1c}\\\\\n\\mathbf{A}_{21} + \\mathbf{B}_{21} & \\mathbf{A}_{22} + \\mathbf{B}_{22} & \\cdots & \\mathbf{A}_{2c} + \\mathbf{B}_{2c} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{A}_{r1} + \\mathbf{B}_{r1} & \\mathbf{A}_{r2} + \\mathbf{B}_{r2} & \\cdots & \\mathbf{A}_{rc} + \\mathbf{B}_{rc} \\\\\n\\end{pmatrix}\n\\end{aligned}\n$${#eq-blockmatrixaddition}\n\n\nwhich is a matrix where each block is the sum of the other blocks. Notice that if each block was a scalar rather than a block matrix, this would be the usual definition of matrix addition (compare @eq-blockmatrixaddition) above to  @eq-matrixaddition). The one requirement is that each of the blocks $\\mathbf{A}_{ij}$ and $\\mathbf{B}_{ij}$ have the same dimension. When this is true, we say that $\\mathbf{A}$ and $\\mathbf{B}$ are **conformable for block matrix addition**. \n\n## Block Matrix Multiplication\n\nIf $\\mathbf{A}$ and $\\mathbf{B}$ are both $m \\times n$ block matrices with blocks in $r$ rows and $c$ columns (same as above) where\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} & =\n\\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} & \\cdots & \\mathbf{A}_{1c}\\\\\n\\mathbf{A}_{21} & \\mathbf{A}_{22} &\\cdots & \\mathbf{A}_{2c} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{A}_{r1} & \\mathbf{A}_{r2} &\\cdots & \\mathbf{A}_{rc} \\\\\n\\end{pmatrix} &\n\\mathbf{B} & =\n\\begin{pmatrix} \\mathbf{B}_{11} & \\mathbf{B}_{12} & \\cdots & \\mathbf{B}_{1c}\\\\\n\\mathbf{B}_{21} & \\mathbf{B}_{22} &\\cdots & \\mathbf{B}_{2c} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{B}_{r1} & \\mathbf{B}_{r2} &\\cdots & \\mathbf{B}_{rc} \\\\\n\\end{pmatrix} \\\\\n\\end{aligned}\n$$\n\n\nand each row of blocks $\\mathbf{A}_{ij}$ has the same number of columns as the block $\\mathbf{B}_{ij}$ has rows, then the block matrices $\\mathbf{A}$ and $\\mathbf{B}$ are said to be **conformable for block matrix multiplication**. A consequence of this is that $r = c$. When this is the case, the matrix products is\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} \\mathbf{B} & =\n\\begin{pmatrix} \\sum_{j = 1}^c \\mathbf{A}_{1j} \\mathbf{B}_{j1} &  \\sum_{j = 1}^c \\mathbf{A}_{1j} \\mathbf{B}_{j2} & \\cdots &  \\sum_{j = 1}^c \\mathbf{A}_{1j} \\mathbf{B}_{jc} \\\\\n\\sum_{j = 1}^c \\mathbf{A}_{2j} \\mathbf{B}_{j1} &  \\sum_{j = 1}^c \\mathbf{A}_{2j} \\mathbf{B}_{j2} & \\cdots &  \\sum_{j = 1}^c \\mathbf{A}_{2j} \\mathbf{B}_{jc} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\sum_{j = 1}^c \\mathbf{A}_{rj} \\mathbf{B}_{j1} &  \\sum_{j = 1}^c \\mathbf{A}_{rj} \\mathbf{B}_{j2} & \\cdots &  \\sum_{j = 1}^c \\mathbf{A}_{rj} \\mathbf{B}_{jc} \n\\end{pmatrix}  \n\\end{aligned}\n$${#eq-column-row-matrix-multiplication}\n\n\nwhich can be said in words as \"each block-element (the $ij$th element $(\\mathbf{A} \\mathbf{B})_{ij}$) of the block-matrix product $\\mathbf{A} \\mathbf{B}$ is the sum of the $i$th block-row of $\\mathbf{A}$ and the $j$th block column of $\\mathbf{B}$. Notice that if each block was a scalar rather than a block matrix, this would be the usual definition of matrix multiplication (compare @eq-blockmatrixmultiplication above to @eq-matrixmultiplication).\n\n::: {#exm-}\nin class\n:::\n\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"}\n\n## Solution\n\nA solution to the example problem\n\n:::\n\n\n## The column-row matrix product\n\n\n::: {#thm-blockmatrixmultiplication}\n\nThe matrix product $\\mathbf{A}\\mathbf{B}$ of an $m \\times n$ matrix $\\mathbf{A} = \\begin{pmatrix} \\mathbf{a}_1 & \\mathbf{a}_2 & \\cdots & \\mathbf{a}_n \\end{pmatrix}$ with columns $\\{\\mathbf{a}_i\\}_{i=1}^n$ and an $n \\times p$ matrix $\\mathbf{B} = \\begin{pmatrix} \\mathbf{b}_1' \\\\ \\mathbf{b}_2' \\\\ \\vdots \\\\ \\mathbf{b}_n' \\end{pmatrix}$ with rows $\\{\\mathbf{b}_i'\\}_{i=1}^n$ can be written as the column-row expansion below:\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} \\mathbf{B} & =\n\\begin{pmatrix} \\mathbf{a}_1 & \\mathbf{a}_2 & \\cdots & \\mathbf{a}_n \\end{pmatrix} \\begin{pmatrix} \\mathbf{b}_1' \\\\ \\mathbf{b}_2' \\\\ \\vdots \\\\ \\mathbf{b}_n' \\end{pmatrix} \\\\\n& = \\mathbf{a}_1 \\mathbf{b}_1' + \\mathbf{a}_2 \\mathbf{b}_2' + \\cdots + \\mathbf{a}_n \\mathbf{b}_n'\n\\end{aligned} \n$${#eq-blockmatrixmultiplication}\n\n\n:::\n\n**Recall:** The notation $\\mathbf{b}_i'$ has a transpose because a vector is defined in the vertical orientation (column vector). Therefore, to formally define a row vector, we take a vertical vector of the values in the row and take its transpose to turn the column vector into a row vector.\n\n::: {#exm-}\nin class\n:::\n\n\n\n## Special Block Matrices\n\nThere are many different forms of block matrices. Two that deserve special mention here include block diagonal matrices and block triangular matrices. \n\n::: {#def-}\n\nThe matrix $\\mathbf{A}$ is said to be block diagonal if\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} = \\begin{pmatrix} \n\\mathbf{A}_1 & \\mathbf{0} & \\mathbf{0} & \\cdots & \\mathbf{0} \\\\\n\\mathbf{0} & \\mathbf{A}_2 & \\mathbf{0} & \\cdots & \\mathbf{0} \\\\\n\\mathbf{0} & \\mathbf{0} & \\mathbf{A}_3 & \\cdots & \\mathbf{0} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{0} & \\mathbf{0} & \\mathbf{0} & \\cdots & \\mathbf{A}_n \\\\\n\\end{pmatrix}\n\\end{aligned}\n$$    \n\n\n\n:::\n\n::: {#def-}\n\nThe matrix $\\mathbf{A}$ is said to be block (upper) triangular if\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} = \\begin{pmatrix} \n\\mathbf{A}_{11} & \\mathbf{A}_{12} & \\mathbf{A}_{13} & \\cdots & \\mathbf{A}_{1n} \\\\\n\\mathbf{0} & \\mathbf{A}_{22} & \\mathbf{A}_{23} & \\cdots & \\mathbf{A}_{2n} \\\\\n\\mathbf{0} & \\mathbf{0} & \\mathbf{A}_{33} & \\cdots & \\mathbf{A}_{3n} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{0} & \\mathbf{0} & \\mathbf{0} & \\cdots & \\mathbf{A}_{nn} \\\\\n\\end{pmatrix}\n\\end{aligned}\n$$    \n\n\n    \n$\\mathbf{A}$ is block (lower) triangular if    \n\n\n$$\n\\begin{aligned}\n\\mathbf{A} = \\begin{pmatrix} \n\\mathbf{A}_{11} & \\mathbf{0} & \\mathbf{0} & \\cdots & \\mathbf{0} \\\\\n\\mathbf{A}_{21} & \\mathbf{A}_{22} & \\mathbf{0} & \\cdots & \\mathbf{0} \\\\\n\\mathbf{A}_{31} & \\mathbf{A}_{32} & \\mathbf{A}_{33} & \\cdots & \\mathbf{0} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\mathbf{A}_{m1} & \\mathbf{A}_{m2} & \\mathbf{A}_{m3} & \\cdots & \\mathbf{A}_{mn} \\\\\n\\end{pmatrix}\n\\end{aligned}\n$$    \n\n\n\n:::\n\n\n::: {#exm-}\nAssume that $\\mathbf{A}$, which has the form\n\n\n$$\n\\mathbf{A} = \\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} \\\\ \\mathbf{0} & \\mathbf{A}_{22} \\end{pmatrix},  \n$$    \n\n\nis an invertible matrix where $\\mathbf{A}_{11}$ a $p \\times p$ invertible matrix, $\\mathbf{A}_{12}$ a $p \\times q$ matrix, and $\\mathbf{A}_{22}$ is a $q \\times q$ invertible matrix. Solve for $\\mathbf{A}^{-1}$\n:::\n\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe inverse to $\\mathbf{A}$ is a matrix $\\mathbf{B} = \\begin{pmatrix} \\mathbf{B}_{11} & \\mathbf{B}_{12} \\\\ \\mathbf{B}_{21} & \\mathbf{B}_{22} \\end{pmatrix}$ with blocks $\\mathbf{B}_{11}$, $\\mathbf{B}_{12}$, $\\mathbf{B}_{21}$, and $\\mathbf{B}_{22}$ of appropriate size to be conformable with the blocks $\\mathbf{A}_{11}$, $\\mathbf{A}_{12}$, and$\\mathbf{A}_{22}$ that make up the matrix $\\mathbf{A}$. \n\nFor $\\mathbf{B}$ to be the inverse of $\\mathbf{A}$, $\\mathbf{A}\\mathbf{B} = \\mathbf{B}\\mathbf{A} = \\mathbf{I} = \\begin{pmatrix} \\mathbf{I} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{I} \\end{pmatrix}$ where $\\mathbf{0}$ is a matrix of zeros of the appropriate size. Writing this out in blocks gives\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{B}\\mathbf{A} & = \\begin{pmatrix} \\mathbf{B}_{11} & \\mathbf{B}_{12} \\\\ \\mathbf{B}_{21} & \\mathbf{B}_{22} \\end{pmatrix}  \\begin{pmatrix} \\mathbf{A}_{11} & \\mathbf{A}_{12} \\\\ \\mathbf{0} & \\mathbf{A}_{22} \\end{pmatrix} \\\\\n& = \\begin{pmatrix} \\mathbf{B}_{11} \\mathbf{A}_{11} & \\mathbf{B}_{11} \\mathbf{A}_{12} + \\mathbf{B}_{12} \\mathbf{A}_{22} \\\\ \\mathbf{B}_{21} \\mathbf{A}_{11} & \\mathbf{B}_{21} \\mathbf{A}_{12} + \\mathbf{B}_{22} \\mathbf{A}_{22}\\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nwhich gives that $\\mathbf{B}_{11} = \\mathbf{A}_{11}^{-1}$ because $\\mathbf{B}_{11}^{-1}\\mathbf{A}_{11} = \\mathbf{I}$ and $\\mathbf{A}_{11}$ is invertible. The equation also give $\\mathbf{B}_{21} \\mathbf{A}_{11} = \\mathbf{0}$ and because $\\mathbf{A}_{11}$ is an invertible matrix, the homogeneous equation $\\mathbf{A}_{11}\\mathbf{b} = \\mathbf{0}$ has only the trivial solution for each column $\\mathbf{b}$ of the matrix $\\mathbf{B}_{21}$  which implies that $\\mathbf{B}_{21} = \\mathbf{0}$. Using these facts, we can rewrite the above equation as\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{B}\\mathbf{A} & = \\begin{pmatrix} \\mathbf{I} & \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} + \\mathbf{B}_{12} \\mathbf{A}_{22} \\\\ \\mathbf{0} & \\mathbf{B}_{22} \\mathbf{A}_{22}\\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nBecause the lower right entry $\\mathbf{B}_{22} \\mathbf{A}_{22}$ must equal $\\mathbf{I}$, we have that $\\mathbf{B}_{22} = \\mathbf{A}_{22}^{-1}$. Then, the equation becomes\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{B}\\mathbf{A} & = \\begin{pmatrix} \\mathbf{I} & \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} + \\mathbf{B}_{12} \\mathbf{A}_{22} \\\\ \\mathbf{0} & \\mathbf{I} \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nThe final component is the upper right block. Because we are finding the inverse, we know that $\\mathbf{0} = \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} + \\mathbf{B}_{12} \\mathbf{A}_{22}$. Subtracting $\\mathbf{A}_{11}^{-1} \\mathbf{A}_{12}$ from both sides of the equation gives\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{B}_{12} \\mathbf{A}_{22} & = - \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} \\\\\n\\mathbf{B}_{12} \\mathbf{A}_{22} \\mathbf{A}_{22}^{-1} & = - \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} \\mathbf{A}_{22}^{-1}\\\\\n\\mathbf{B}_{12} \\mathbf{I} & = - \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} \\mathbf{A}_{22}^{-1}\\\\\n\\mathbf{B}_{12} & = - \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} \\mathbf{A}_{22}^{-1}\n\\end{aligned}\n$$\n\n\n\nThus, $\\mathbf{A}^{-1} = \\begin{pmatrix} \\mathbf{A}_{11}^{-1} & - \\mathbf{A}_{11}^{-1} \\mathbf{A}_{12} \\mathbf{A}_{22}^{-1} \\\\ \\mathbf{0} & \\mathbf{A}_{22}^{-1} \\end{pmatrix}$\n\n:::\n\n\n\n",
    "supporting": [
      "02-block-matrices_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}