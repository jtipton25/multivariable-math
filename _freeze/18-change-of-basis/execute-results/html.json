{
  "hash": "ed6d91d5f91aa7a0dc2caf4c3cb91a39",
  "result": {
    "markdown": "# Change of basis\n\n- [3 Blue 1 Brown -- Change of basis](https://www.3blue1brown.com/lessons/change-of-basis)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dasc2594)\n```\n:::\n\n\nConsider two bases $\\mathcal{B} = \\{ \\mathbf{b}_1, \\ldots, \\mathbf{b}_n \\}$ and $\\mathcal{C} = \\{ \\mathbf{c}_1, \\ldots, \\mathbf{c}_n \\}$ for a vector space $\\mathcal{V}$. If we have a vector $\\left[\\mathbf{x}\\right]_B$ with coordinates in $\\mathcal{B}$, what are the coordinates of $\\left[\\mathbf{x}\\right]_C$ with respect to $\\mathcal{C}$?\n\n* Recall: we know how to change from the standard coordinates to the basis $\\mathcal{B}$. If $\\mathbf{x}$ is a vector in the standard coordinates and $\\mathbf{B} = \\begin{pmatrix} \\mathbf{b}_1 & \\ldots & \\mathbf{b}_n \\end{pmatrix}$ is a matrix with columns given by the basis $\\mathbf{B}$, the coordinates of $\\left[\\mathbf{x}\\right]_B$ of the vector $\\mathbf{x}$ with respect to the basis $\\mathcal{B}$ are \n$$\n\\begin{aligned}\n\\left[\\mathbf{x}\\right]_B = \\mathbf{B}^{-1} \\mathbf{x}\n\\end{aligned}\n$$\nand, as a consequence, given a vector $\\left[\\mathbf{x}\\right]_B$ with coordinates with respect to the basis $\\mathcal{B}$, the vector of coefficients $\\mathbf{x}$ with standard coordinates is given by \n$$\n\\begin{aligned}\n\\mathbf{x} = \\mathbf{B} \\left[\\mathbf{x}\\right]_B.\n\\end{aligned}\n$$\n\nNotice that change of coordinates is a linear transformation from $\\mathcal{B}$ to $\\mathcal{C}$ with transformation matrix $\\mathbf{A}$. Despite the more complex notation, this is just another linear transformation [[link](https://www.youtube.com/watch?v=VGhij2qmOs4)].\n\n::: {#exm-}\nShow the change of basis from the basis $\\mathcal{B} = \\left\\{ \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\right\\}$ to the basis $\\mathcal{C} = \\left\\{ \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ -\\frac{1}{2} \\end{pmatrix}\\right\\}$. To do this, represent the columns that make up the basis $\\mathcal{B}$ as the matrix $\\mathbf{B} = \\begin{pmatrix} \\frac{1}{2} & -1 \\\\ 1 & 0 \\end{pmatrix}$ and represent the columns that make up the basis $\\mathcal{C}$ as the matrix $\\mathbf{C} = \\begin{pmatrix} 0 & \\frac{1}{2} \\\\ 1 & -\\frac{1}{2} \\end{pmatrix}$. Then, the change of basis can be represented as\n\n\n::: {.cell hash='18-change-of-basis_cache/html/change-basis_70f0ba6ee9691e86aecd6304446b63cb'}\n\n```{.r .cell-code}\nB <- matrix(c(1/2, 1, -1, 0), 2, 2)\nC <- matrix(c(0, 1/2, 1, -1/2), 2, 2)\n\np <- plot_change_basis(B, C)\n```\n:::\n\n::: {.cell hash='18-change-of-basis_cache/html/change-basis-animation_508910d86a27c158759f6d7be216a2f0'}\n::: {.cell-output-display}\n![](18-change-of-basis_files/figure-html/change-basis-animation-1.gif)\n:::\n:::\n\n\nwhich can be represented with the static images \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](18-change-of-basis_files/figure-html/change-basis-static-1.png){width=672}\n:::\n:::\n\n\nThe change of basis represents a linear transformation. When previously discussing linear transformations in @sec-linear-transformations, we considered a linear transformation from the standard basis $\\mathcal{I}$ defined by the basis vectors $\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}$ with the vectors represented as the columns of the identity matrix $\\mathbf{I}$. We can consider a change of basis as two consecutive linear transformations. First, a linear transformation from the basis $\\mathcal{B}$ to the standard basis $\\mathcal{I}$ and then a linear transformation from the standard basis $\\mathcal{I}$ to the basis $\\mathcal{C}$. This can be represented using the following example code:\n\n\n\n::: {.cell hash='18-change-of-basis_cache/html/change-basis-I_dd25814228037b8a370cfc7902eca7c8'}\n\n```{.r .cell-code}\np <- plot_change_basis(B, C, plot_standard_basis = TRUE)\n```\n:::\n\n::: {.cell hash='18-change-of-basis_cache/html/change-basis-I-animation_0fb2877fe7dc08409ace9775e480ed5e'}\n::: {.cell-output-display}\n![](18-change-of-basis_files/figure-html/change-basis-I-animation-1.gif)\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](18-change-of-basis_files/figure-html/change-basis-I-static-1.png){width=672}\n:::\n:::\n\n\n\n## Changing coordinates between different bases\n\nNow, we can combine these ideas. Given a vector $\\left[\\mathbf{x}\\right]_B$ written with coordinates with respect to the basis $\\mathcal{B}$, we can find the coordinates of $\\left[\\mathbf{x}\\right]_C$ with respect to the basis $\\mathcal{C}$. First, we find the coordinates of the vector  $\\mathbf{x}$ with respect to the standard basis then find the coordinates of $\\left[\\mathbf{x}\\right]_C$ with respect to the basis $\\mathcal{C}$. Let $\\mathbf{B} = \\begin{pmatrix} \\mathbf{b}_1 & \\ldots & \\mathbf{b}_n \\end{pmatrix}$ and $\\mathbf{C} = \\begin{pmatrix} \\mathbf{c}_1 & \\ldots & \\mathbf{c}_n \\end{pmatrix}$, then given a vector $\\left[\\mathbf{x}\\right]_B$ with coordinates with respect to the basis $\\mathcal{B}$, the coordinates $\\left[\\mathbf{x}\\right]_C$ of this vector with respect to the basis $\\mathcal{C}$ is \n$$\n\\begin{aligned}\n\\left[\\mathbf{x}\\right]_C = \\mathbf{C}^{-1} \\mathbf{B} \\left[\\mathbf{x}\\right]_B.\n\\end{aligned}\n$$\n\n**Draw diagram**\n\nx\n::: {#exm-}\n\n\n::: {.cell}\n\n:::\n\n\nWorking with the same bases $\\mathcal{B} = \\left\\{ \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\right\\}$ and $\\mathcal{C} = \\left\\{ \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\end{pmatrix}, \\begin{pmatrix} 1 \\\\ -\\frac{1}{2} \\end{pmatrix}\\right\\}$ from the previous example, Let $\\left[\\mathbf{x}\\right]_B = \\begin{pmatrix} -3/2 \\\\ 1/2 \\end{pmatrix}$ be the coordinates of the vector $\\mathbf{x}$ with respect to the basis $\\mathcal{B} = \\left\\{ \\begin{pmatrix} 1/2 \\\\ 1 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\right\\}$. Find\n\n1) the coordinates of $\\mathbf{x}$ with respect to the standard basis and\n2) the coordinates of $\\mathbf{x}$ with respect to the basis $\\mathcal{C}$.\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nHere we solve the two questions from the example above.\n\n1) Recall that the coordinates $\\left[\\mathbf{x}\\right]_B$ of $\\mathbf{x}$ with respect to the basis $\\mathcal{B}$ mean that the vector $\\mathbf{x}$ can be written as a linear combination of the basis vectors $\\mathbf{b}_1$ and $\\mathbf{b}_2$ with coefficients given by the elements in $\\left[\\mathbf{x}\\right]_B = \\begin{pmatrix} \\left[x_1\\right]_B \\\\ \\left[x_2\\right]_B \\end{pmatrix}$. This results in the equation\n\n$$\n\\begin{aligned}\n\\mathbf{x} & = \\left[x_1\\right]_B \\mathbf{b}_1 + \\left[x_2\\right]_B \\mathbf{b}_2\n\\end{aligned}\n$$\nPlugging the values from the example gives \n$$\n\\begin{aligned}\n\\mathbf{x} & = \\left[x_1\\right]_B \\mathbf{b}_1 + \\left[x_2\\right]_B \\mathbf{b}_2 \\\\\n& = -1.5 \\begin{pmatrix} 1/2 \\\\ 1 \\end{pmatrix} + 0.5 \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} \\\\\n& = \\begin{pmatrix} -3/4 \\\\ -3/2 \\end{pmatrix} + \\begin{pmatrix} -1/2 \\\\ 0 \\end{pmatrix} \\\\\n& = \\begin{pmatrix} -5/4 \\\\ -3/2 \\end{pmatrix}\n\\end{aligned}\n$$\n2) Now, recall the coordinates $\\left[\\mathbf{x}\\right]_C$ of $\\mathbf{x}$ with respect to the basis $\\mathcal{C}$ mean that the vector $\\mathbf{x}$ can be written as a linear combination of the basis vectors $\\mathbf{c}_1$ and $\\mathbf{c}_2$ with coefficients given by the elements in $\\left[\\mathbf{x}\\right]_C = \\begin{pmatrix} \\left[x_1\\right]_C \\\\ \\left[x_2\\right]_C \\end{pmatrix}$. This results in the equation\n\n$$\n\\begin{aligned}\n\\mathbf{x} & = \\left[x_1\\right]_C \\mathbf{c}_1 + \\left[x_2\\right]_C \\mathbf{c}_2\n\\end{aligned}\n$$\nHowever, unlike part (1), we do not know the coefficients $\\left[\\mathbf{x}\\right]$ but need to solve for them. Rewriting the above equation in the form of $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ gives\n$$\n\\begin{aligned}\n\\mathbf{C} \\left[ \\mathbf{x} \\right]_C & = \\mathbf{x}\n\\end{aligned}\n$$\nBecause the matrix of basis vectors $\\mathbf{C}$ is an invertible matrix (a basis is a linearly independent spanning set),  the coefficients $\\left[\\mathbf{x}\\right]_C$ can be solved using the equation\n$$\n\\begin{aligned}\n\\mathbf{C} \\left[ \\mathbf{x} \\right]_C & = \\mathbf{x} \\\\\n\\mathbf{C}^{-1} \\mathbf{C}\\left[ \\mathbf{x} \\right]_C & = \\mathbf{C}^{-1}\\mathbf{x} \\\\\n\\left[ \\mathbf{x} \\right]_C & = \\mathbf{C}^{-1} \\mathbf{x} \n\\end{aligned}\n$$\nThe matrix inverse $\\mathbf{C}^{-1}$ can be found using @thm-matrix2by2 to get $\\mathbf{C}^{-1} = \\begin{pmatrix} 1 & 2 \\\\ 1 & 0 \\end{pmatrix}$. Then, plugging in the values from the example gives \n\n$$\n\\begin{aligned}\n\\left[ \\mathbf{x} \\right]_C & = \\mathbf{C}^{-1} \\mathbf{x} \\\\\n& = \\begin{pmatrix} 1 & 2 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} -5/4 \\\\ -3/2 \\end{pmatrix} \\\\\n& = \\begin{pmatrix} -17/4 \\\\ -5/4 \\end{pmatrix}\n\\end{aligned}\n$$\nAnother way to change coordinates is to change directly from basis $\\mathcal{B}$ to $\\mathcal{C}$ without going through the intermediate transformation to the standard coordinates. Combining the results from (1) and (2) gives\n$$\n\\begin{aligned}\n\\left[ \\mathbf{x} \\right]_C & = \\mathbf{C}^{-1} \\mathbf{x} \\\\\n& = \\mathbf{C}^{-1} \\mathbf{B} \\left[\\mathbf{x}\\right]_B\n\\end{aligned}\n$$ \nso that one can change coordinates from the basis $\\mathcal{B}$ to the basis $\\mathcal{C}$ using the linear transformation defined by the matrix multiplication $\\mathbf{C}^{-1} \\mathbf{B}$.\n\nIn `R`, first define the basis matrices `B` and `C` and the coordinates `x_b` of the vector $\\mathbf{x}$ with respect to the basis $\\mathcal{B}$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB <- matrix(c(1/2, 1, -1, 0), 2, 2)\nC <- matrix(c(0, 1/2, 1, -1/2), 2, 2)\nx_b <- c(-3/2, 1/2)\n```\n:::\n\n\n1\\) The coordinates `x` with respect to the standard basis is\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- B %*% x_b\nx\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]\n[1,] -1.25\n[2,] -1.50\n```\n:::\n:::\n\n\n2\\) The coordinates `x_c` with respect to the basis $\\mathcal{C}$ can be found by calculating the matrix inverse `C_inv` and then using the matrix inverse to calculate the coordinates with respect to the basis $\\mathcal{C}$ as\n\n::: {.cell}\n\n```{.r .cell-code}\nC_inv <- solve(C)\nx_c <- C_inv %*% x\nx_c\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]\n[1,] -4.25\n[2,] -1.25\n```\n:::\n:::\n\n\nDone as a single transformation, the linear transformation is defined as\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB %*% C_inv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2]\n[1,] -0.5    1\n[2,]  1.0    2\n```\n:::\n:::\n\nwhich gives the coordinates\n\n::: {.cell}\n\n```{.r .cell-code}\nB %*% C_inv %*% x_b\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]\n[1,]  1.25\n[2,] -0.50\n```\n:::\n:::\n\n:::\n\n\n::: {#exm-}\n3-d change of basis\n:::\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}