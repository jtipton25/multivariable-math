{
  "hash": "fe35d93ee9146d62431214620dc463cf",
  "result": {
    "markdown": "# The chain rule\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(plotly)\nlibrary(dasc2594)\nset.seed(2021)\n```\n:::\n\n\nRecall the univariate chain rule: If $y = f(x)$ is a function of $x$ and $z = g(y)$ is a function of $y$, a question of interest is \"What is the change in $z$ relative to change in $x$?\n\nWe can write $z = g(y) = g(f(x))$ and using this notation, the change in $z$ with respect to the variable $x$ is $\\frac{dz}{dx} = \\frac{dz}{dy}\\frac{dy}{dx} = \\frac{df(y)}{dy}\\frac{dg(x)}{dx}$. Written in functional form\n\n$$\n\\begin{aligned}\n(g(f(x)))' = (g \\circ f)'(x) = g'(f(x)) f'(x)\n\\end{aligned}\n$$\n\n\n::: {#exm-}\nLet $z = f(y) = y^3$ and let $y = g(x) = e^{x}$ what is $\\frac{dz}{dx}$?\n:::\n\n## The chain rule with one independent variable\n\n**Drawing in class**\n\n::: {#def-}\n## Chain Rule For One Independent Variable\n\nLet $z$ be a differentiable function of two variables $x$ and $y$ so that $z = f(x, y)$ and let $x=g(t)$ be a function of $t$ and $y=h(t)$ a function of $t$. Written in functional form, $z$ can be written as $z = f(x, y) = f(g(t), h(t))$, with $x=g(t)$ and $y=h(t)$. Then we can define the derivative of $z$ with respect to $t$ as \n\n$$\n\\begin{aligned}\n\\frac{dz}{dt} = \\frac{\\partial z}{ \\partial x}\\frac{dx}{dt} + \\frac{\\partial z}{\\partial y}\\frac{dy}{dt}\n\\end{aligned}\n$$\n\n    \n* For the definition above, we have the dependent variable $z$ and we have **intermediate variables** $x$ and $y$. \n\n* Notice in the definition above that there is a mix of partial derivatives ($\\partial$) and ordinary derivatives ($d$).\n\n:::\n<!-- Could be added to above definition -->\n<!-- . Then $z = f(g(t), h(t))$ -->\n<!-- \\begin{aligned} -->\n<!-- f(g(t), h(t)) = \\frac{dz}{dx}\\frac{dx}{dt} + \\frac{dz}{dy}\\frac{dy}{dt} -->\n<!-- \\end{aligned} -->\n\n::: {#exm-}\nLet $z = x^2 + e^y$ and let $x = \\cos(t)$ and $y = \\sin(t)$ \n:::\n\n\nThe results from above can also be extended to have more than two intermediate variables. \n\n**Draw picture**\n\n## The chain rule with several independent variables\n\nOften, functions will have more than one independent variables. \n\n::: {#def-}\n## Chain Rule For Two Independent Variables\nLet $z$ be a differentiable function of two variables $x$ and $y$ so that $z = f(x, y)$ and let $x=g(t, s)$ be a function of $s$ and $t$ and $y=h(s, t)$ a function of $s$ and $t$. Written in functional form, $z$ can be written as $z = f(x, y) = f(g(s, t), h(s, t))$, with $x=g(s, t)$ and $y=h(s, t)$. Then we can define the partial derivative of $z$ with respect to $s$ as \n\n$$\n\\begin{aligned}\n\\frac{\\partial z}{\\partial s} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial s} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial s}\n\\end{aligned}\n$$\n\nthe partial derivative of $z$ with respect to $t$ as \n\n$$\n\\begin{aligned}\n\\frac{\\partial z}{\\partial t} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial t} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial t}\n\\end{aligned}\n$$\n\n:::\n\n\n::: {#exm-}\nLet $z = f(x, y) = x^2 e^y$ and let $x = 2s - t$ and $y = 4s^3-3t^2$\n:::\n\n\n\n<!-- ## Implicit differentiation -->\n\n## The chain rule in matrix notation\n\n\nTo get a better understanding of the chain rule, it helps to show the chain rule using matrix notation. Using the matrix notation will enable you to apply the chain rule to any number of intermediate variables. For example, consider the extension of the definition for the chain rule of a function with one independent variable. \n\n::: {#def-}\n## Matrix Chain Rule For One Independent Variable\n\nLet $z$ be a differentiable function of two variables $x$ and $y$ so that $z = f(x, y)$ and let $x=g(t)$ be a function of $t$ and $y=h(t)$ a function of $t$. Written in functional form, $z$ can be written as $z = f(x, y) = f(g(t), h(t))$, with $x=g(t)$ and $y=h(t)$. Then we can define the derivative of $z$ with respect to $t$ as \n\n$$\n\\begin{aligned}\n\\frac{dz}{dt} = \\frac{\\partial z}{ \\partial x}\\frac{dx}{dt} + \\frac{\\partial z}{\\partial y}\\frac{dy}{dt}\n\\end{aligned}\n$$\n\n    \nWritten in matrix notation, this is \n\n$$\n\\begin{aligned}\n\\frac{dz}{dt} = \\begin{pmatrix} \\frac{\\partial z}{ \\partial x} & \\frac{\\partial z}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\frac{dx}{dt} \\\\  \\frac{dy}{dt} \\end{pmatrix} = \\frac{\\partial z}{ \\partial x}\\frac{dx}{dt} + \\frac{\\partial z}{\\partial y}\\frac{dy}{dt}\n\\end{aligned}\n$$\n\n:::\n\nThe definition above for the chain rule with two variables is given by \n\n::: {#def-}\n## Chain Rule For Two Independent Variables\n\nLet $z$ be a differentiable function of two variables $x$ and $y$ so that $z = f(x, y)$ and let $x=g(t, s)$ be a function of $s$ and $t$ and $y=h(s, t)$ a function of $s$ and $t$. Written in functional form, $z$ can be written as $z = f(x, y) = f(g(s, t), h(s, t))$, with $x=g(s, t)$ and $y=h(s, t)$. Then we can define the partial derivative of $z$ with respect to $s$ as \n\n$$\n\\begin{aligned}\n\\frac{\\partial z}{\\partial s} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial s} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial s}\n\\end{aligned}\n$$\n\nwhich, in matrix notation is\n\n$$\n\\begin{aligned}\n\\frac{dz}{dt} = \\begin{pmatrix} \\frac{\\partial z}{ \\partial x} & \\frac{\\partial z}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial x}{\\partial s} \\\\  \\frac{\\partial y}{\\partial s} \\end{pmatrix} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial s} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial s}\n\\end{aligned}\n$$\n\n    \nThe partial derivative of $z$ with respect to $t$ as \n\n$$\n\\begin{aligned}\n\\frac{\\partial z}{\\partial t} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial t} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial t}\n\\end{aligned}\n$$\n\nwhich, in matrix notation is\n\n$$\n\\begin{aligned}\n\\frac{dz}{dt} = \\begin{pmatrix} \\frac{\\partial z}{ \\partial x} & \\frac{\\partial z}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial x}{\\partial t} \\\\  \\frac{\\partial y}{\\partial t} \\end{pmatrix} = \\frac{\\partial z}{ \\partial x}\\frac{\\partial x}{\\partial t} + \\frac{\\partial z}{\\partial y}\\frac{\\partial y}{\\partial t}\n\\end{aligned}\n$$\n\n:::\n\nThis use of matrix notation for derivatives will be useful in understanding the **gradient**.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}