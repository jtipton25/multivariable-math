{
  "hash": "c1596ed1153bb24f1c5d63754c4d1779",
  "result": {
    "markdown": "# Linear Systems of Equations {#linear-systems-of-equations}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# For 3-d plotting\n# if devtools package not installed, install the package\nif (!require(devtools)) {\n    install.packages(\"devtools\")\n}\n# if gg3D package not installed, install the package\nif (!require(gg3D)) {\n    devtools::install_github(\"AckerDWM/gg3D\")\n    library(gg3D)\n}\n\n# if dasc2594 package not installed, install the package\nif (!require(dasc2594)) {\n    devtools::install_github(\"jtipton25/dasc2594\")\n    library(dasc2594)\n}\n```\n:::\n\n\n## Linear Systems of equations\n### Linear equations\n\n::: {#def-}\n## Linear Equations\nLet $x_1, x_2, \\ldots, x_n$ be **variables** with **coefficients** $a_1, a_2, \\ldots, a_n$, and $b$ are fixed and known numbers. Then, we say\n\n$$\n\\begin{aligned}\na_1 x_1 + a_2 x_2 + \\cdots + a_n x_n & = b\n\\end{aligned}\n$${#eq-linear}\n\nis a **linear equation**. \n:::\n\n\n::: {#exm-}\nShow the equation for a line with slope $m$ and $y$-intercept $b$ is\n\n$$\n\\begin{aligned}\ny & = m x + b,\n\\end{aligned}\n$$\n\nis a linear equation.\n\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"}\n## Solution\n\nThe equation for a line with slope $m$ and $y$-intercept $b$ is\n\n$$\n\\begin{aligned}\ny & = m x + b,\n\\end{aligned}\n$$\n\nis a linear equation because it can be re-written as \n\n$$\n\\begin{aligned}\ny - m x & = b,\n\\end{aligned}\n$$\n\nwhere $a_1 = 1$, $a_2 = m$, $x_1 = y$, $x_2 = x$, and $b=b$.\n:::\n\n::: {#exm-}\nDetermine if the equation below is a linear equation\n\n$$\n\\begin{aligned}\n\\sqrt{19} x_1 & = (4 + \\sqrt{2}) x_2 - x_3 - 9.\n\\end{aligned}\n$$\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"}\n## Solution\n\nThe equation\n\n$$\n\\begin{aligned}\n\\sqrt{19} x_1 & = (4 + \\sqrt{2}) x_2 - x_3 - 9\n\\end{aligned}\n$$\n\nis a linear equation because it can be written as \n\n$$\n\\begin{aligned}\n\\sqrt{19} x_1 - (4 + \\sqrt{2}) x_2 + x_3 & = - 9\n\\end{aligned}\n$$\nwhere $a_1 = \\sqrt{19}$, $a_2 = 4 + \\sqrt{2}$, $a_3 = 1$ and $b = -9$\n:::\n\n\n::: {#exm-}\nDetermine if the equation below is a linear equation\n\n$$\n\\begin{aligned}\n-4 x_1 + 5 x_2 - 11 & = x_3.\n\\end{aligned}\n$$\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe equation\n\n$$\n\\begin{aligned}\n-4 x_1 + 5 x_2 - 11 & = x_3\n\\end{aligned}\n$$\nis a linear equation because it can be written as \n\n$$\n\\begin{aligned}\n-4 x_1 + 5 x_2 - x_3 & = 11.\n\\end{aligned}\n$$\n:::\n\n\n::: {#exm-}\nDetermine if the equation\n\n$$\n\\begin{aligned}\nx_1 & = x_2^2 + 3\n\\end{aligned}\n$$\n\nis a linear equation.\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe equation\n\n$$\n\\begin{aligned}\nx_1 & = x_2^2 + 3\n\\end{aligned}\n$$\n\nis not a linear equation because it does not meet the form of @eq-linear because the equation has a quadratic power of $x_2$.\n:::\n\n\n::: {#exm-}\nDetermine if the equation\n\n$$\n\\begin{aligned}\nx_1 + x_2 - x_1 x_2 & = 16\n\\end{aligned}\n$$\n\nis a linear equation.\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe equation\n\n$$\n\\begin{aligned}\nx_1 + x_2 - x_1 x_2 & = 16\n\\end{aligned}\n$$\n\nis not a linear equation because it does not meet the form of @eq-linear because there is a product $x_1x_2$ of $x_1$ and $x_2$.\n:::\n\n\n::: {#exm-}\nIs the following equation a linear equation?\n$x_1 + 3 x_1 x_2 = 5$\n:::\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThis is a linear equation because the equation can be written as $a_1 x_1 + a_2 x_2 = b$ where $a_1 = 1$, $a_2 = 3$ and $b = 5$\n:::\n\n\n::: {#exm-}\nIs the following equation a linear equation?\n$5x + 7y + 8z = 11.2$\n:::\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThis is a linear equation because the equation can be written as $a_1 x_1 + a_2 x_2 + a_3 x_3= b$ where $a_1 = 5$, $a_2 = 7$, $a_3 = 8$ and $b = 11.2$. The variables $x_1 = x$, $x_2 = y$, and $x_3 = z$.\n:::\n\n::: {#exm-}\nIs the following equation a linear equation?\n$\\frac{1}{4} y + \\sqrt{2} z = 2^6$\n:::    \n    \n    \n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThis is a linear equation because the equation can be written as $a_1 x_1 + a_2 x_2 = b$ where $a_1 = \\frac{1}{4}$, $a_2 = \\sqrt{2}$, and $b = 2^6$. The variables $x_1 = y$, $x_2 = z$ enter the equation linearly.\n:::\n\n::: {#exm-}\nIs the following equation a linear equation?\n$x + 4 y^2 = 9$\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThis is not a linear equation because the equation cannot be written as $a_1 x_1 + a_2 x_2 = b$ because $x_1 = x$ and $x_2 = y$ so that the equation is written as $a_1 x_1 + a_2 x_2^2 = b$ where $a_1 = 1$, $a_2 = 4$, and $b = 9$. The variable $x_2 = y$ enters the equation in a non-linear (quadratic) manner.\n:::\n\n\n\n\n### Systems of linear equations\n\n::: {#def-}\n## System of Equations\n\nA set of two or more linear equations that each contain the same set of variables is called a **system of linear equations**. \n\n:::\n\n\n::: {#exm-}\nDetermine if the following equations are a system of linear equations.\n\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}{} &     & {}={} & 9.\n\\end{alignat*}\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe set of equations\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}{} &     & {}={} & 9.\n\\end{alignat*}\nare a system of equations. Note that in the second equation, the coefficient for $x_3$ is 0, meaning we could re-write the above example as\n\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 0 x_3 & {}={} & 9.\n\\end{alignat*}\n:::\n\n\n\n::: {#exm-}\nDetermine if the following equations are a system of linear equations.\n\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_1 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 2 x_3 & {}={} & \\pi.\n\\end{alignat*}\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nThe set of equations\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_1 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 2 x_3 & {}={} & \\pi\n\\end{alignat*}\nare not a linear system of equations. Note that in the first equation, there is a nonlinear term $x_1 x_2$ and because of this, equation one cannot be written in the form of @eq-linear.\n:::\n\nFor the remainder of the section on linear algebra, we will focus on linear equations.\n\n\n\n### Solutions of linear systems\n\nA fundamental question when presented with a linear system of equations is whether the system has a solution. \n\n::: {#def-}\n## Solution of Systems of Equations\n\nA solution to a system means that there are numbers $(s_1, s_2, \\ldots, s_n)$ that each of the variables $x_1, x_2, \\ldots, x_n$ take that allow for all the equations to simultaneously be true.\n:::\n\n\nChecking if a vector is a solution is straightforward. You just substitute the values of the vector into the equations and see if the equations are satisfied. For example, if we consider the equation\n$$\nx_1 + x_2 = 7,\n$$\nthe vector $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 3 \\end{pmatrix}$ is a valid solution because \n$$\n4 + 3 = 7\n$$\nbut the vector $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 9 \\end{pmatrix}$ is not a valid solution because \n$$\n5 + 9 \\neq 7.\n$$\n\n\n\n::: {.cell}\n\n:::\n\n\n::: {#exm-}\nIs $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 3 \\\\ 6 \\end{pmatrix}$ a solution to the system of equations\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 0 x_3 & {}={} & 9?\n\\end{alignat*}\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nFirst, we plug in the values for $x_1 = 5$, $x_2 = 3$  and $x_3 = 6$ into the system of equations. In the first equation, we get\n\\begin{alignat*}{4}\n5   & {}+{} & 4 \\times 3 & {}-{} & 6 & {}={} & 11 \\\\\n\\end{alignat*}\nwhich is true because $11 = 11$. Now we consider the second equation\n\n\\begin{alignat*}{4}\n4 \\times 5 & {}+{} & 5 \\times 3 & {}+{} & 0 \\times 6 & {}={} & 9.\n\\end{alignat*}\nwhich is false because $35 \\neq 9$. Thus, $\\mathbf{x} = \\begin{pmatrix} 5 \\\\ 3 \\\\ 6  \\end{pmatrix}$ is not a solution to the system of equations in the given example.\n:::\n\n\n::: {#exm-}\nFinding a solution a system of equations is more challenging. To find a solution, we add/subtract equations to cancel out variables. For example, consider the following example. You work in a small zoo. In the zoo, there are ostriches (one head, two legs, and no horns), one-horned rhinos (one head, four legs, and one horn), and two-horned antelope (one head, four legs, and two horns). Consider the following statements about the set of animals in the zoo:\n\n1) There are 12 heads\n\n2) There are 38 feet\n\n3) There are 10 horns\n\nUsing this information, how many ostriches, rhinos, and antelope are there.\n\n:::\n\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nLetting the variable $o$ represent the number of ostriches, $r$ represent the number of rhinos, and $a$ represent the number of antelope. Then, the three statements above can be represented mathematically by the system of equations\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n2o  & {}+{} &  4r & {}+{} & 4a & {}={} & 38 \\\\\n0o  & {}+{} &  r  & {}+{} & 2a & {}={} & 10.\n\\end{alignat*}\nLooking at the third equation, we can solve for the number of rhinos $r$ as $r = 10 - 2a$. Substituting this into the first two equations gives\n\\begin{alignat*}{4}\no   & {}+{} &  10 - 2a  & {}+{} & a  & {}={} & 12 \n\\end{alignat*}\nand \n\\begin{alignat*}{4}\n2o  & {}+{} &  4(10 - 2a) & {}+{} & 4a & {}={} & 38 \n\\end{alignat*}\nThe first equation from above gives $o + 10 - 2a + a = 12$ and solving for $o$ as a function of $a$ gives $o = 2 + a$. The second equation from above gives $2o + 4(10 - 2a) + 4a = 38$ and solving for $o$ as a function of $a$ gives $o = 2a - 1$. Combining both of these gives $2 + a = 2a - 1$ which gives $a = 3$ so that we know there are 3 antelope. Going backwards, we know that $o = 2a - 1$ and plugging in $a = 3$ gives $o = 5$ which tells us that there are 5 ostriches in the zoo. In addition, we know that $r = 10 - 2a$ and, when plugging in the value $a = 3$, we find that there are $r = 4$ rhinos at the zoo. \n\nWhile solving for variables like above is possible, it can be quite difficult to keep track of the steps in the calculation. To simplify the process, one can add and subtract entire equations. For example, starting with the system of equations from the zoo example \n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n2o  & {}+{} &  4r & {}+{} & 4a & {}={} & 38 \\\\\n0o  & {}+{} &  r  & {}+{} & 2a & {}={} & 10.\n\\end{alignat*}\nwe can add and subtract entire equations. For example, take the second equation and subtract 2 times the first equation to get the system of equations\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n2o - 2 \\times o & {}+{} &  4r - 2 \\times r & {}+{} & 4a -2 \\times a& {}={} & 38 - 2 \\times 12\\\\\n0o  & {}+{} &  r  & {}+{} & 2a & {}={} & 10,\n\\end{alignat*}\nwhich, when simplified is\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  2r & {}+{} & 2a & {}={} & 14 \\\\\n0o  & {}+{} &  r  & {}+{} & 2a & {}={} & 10.\n\\end{alignat*}\n\nTaking the third equation and subtracting $\\frac{1}{2}$ times the second equation gives\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  2r & {}+{} & 2a & {}={} & 14 \\\\\n0o  & {}+{} &  r - \\frac{1}{2} \\times 2r  & {}+{} & 2a - \\frac{1}{2} \\times 2a & {}={} & 10 - \\frac{1}{2} \\times 14,\n\\end{alignat*}\nwhich is the system of equations\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  2r & {}+{} & 2a & {}={} & 14 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3.\n\\end{alignat*}\nBecause $a = 3$, there are 3 antelope at the zoo. Now, we can use these systems of equations to subtract 2 times the third equation from the second equation to get\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  2r & {}+{} & 2a - 2 \\times a & {}={} & 14 - 2 \\times 3 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nwhich gives the system of equations\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  2r & {}+{} & 0a & {}={} & 8 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nand dividing the second equation by 2 gives\n\\begin{alignat*}{4}\no   & {}+{} &  r  & {}+{} & a  & {}={} & 12 \\\\\n0o  & {}+{} &  r & {}+{} & 0a & {}={} & 4 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nso that we know there are 4 rhinos in the zoo. Taking the first equation and subtracting the second equation gives the system of equations\n\\begin{alignat*}{4}\no   & {}+{} &  r - r  & {}+{} & a  & {}={} & 12 - 4\\\\\n0o  & {}+{} &  r & {}+{} & 0a & {}={} & 4 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nwhich is \n\\begin{alignat*}{4}\no   & {}+{} &  0r  & {}+{} & a  & {}={} & 8 \\\\\n0o  & {}+{} &  r & {}+{} & 0a & {}={} & 4 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nand subtracting the third equation from the first equation gives\n\\begin{alignat*}{4}\no   & {}+{} &  0r  & {}+{} & a - a  & {}={} & 8 - 3 \\\\\n0o  & {}+{} &  r & {}+{} & 0a & {}={} & 4 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nwhich gives\n\\begin{alignat*}{4}\no   & {}+{} &  0r  & {}+{} & 0a  & {}={} & 5 \\\\\n0o  & {}+{} &  r & {}+{} & 0a & {}={} & 4 \\\\\n0o  & {}+{} &  0r  & {}+{} & a & {}={} & 3, \n\\end{alignat*}\nwhich tells us that there are $o=5$ ostriches at the zoo.\n:::\n\n\n::: {#exm-exampleonesolution}\nConsider the system of equations\n\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 5 y & {}={} & 7.\n\\end{alignat*}\n\nFind a solution to the system of equations.\n\n:::\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nTo find if a solution to this equation exists, we can do some algebra and take 4 times the top equation and then subtract the bottom equation, replacing the bottom equation with this new sum like\n\n\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x - 4 \\times (x) & {}+{} & 5 y - 4 \\times (4y) & {}={} & 7 - 4 \\times (8),\n\\end{alignat*}\nwhere the part of the equations in ($\\cdot$) is the top equation. This system of equations now simplifies to \n\\begin{alignat*}{3}\nx & {}+{} & 4 y & {}={} & 8 \\\\\n0 & {}+{} & - 11y & {}={} & -25,\n\\end{alignat*}\nwhich gives $y = \\frac{25}{11}$. Plugging this value into the top equation gives\n\\begin{alignat*}{3}\nx & {}+{} & 4 \\frac{25}{11} & {}={} & 8 \\\\\n0 & {}+{} & y & {}={} & \\frac{25}{11},\n\\end{alignat*}\nwhere we can solve $x = 8 - \\frac{100}{11} = -\\frac{12}{11}$ giving the solution of the form\n\\begin{alignat*}{3}\nx & {}+{} & 0 & {}={} & -\\frac{12}{11} \\\\\n0 & {}+{} & y & {}={} & \\frac{25}{11},\n\\end{alignat*}\nIn this case, the system of equation has the solution $x = -\\frac{12}{11}$ and $y = \\frac{25}{11}$. While finding the solution can be done algebraically, what does this mean visually (geometrically)? The original equations were \n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 5 y & {}={} & 7,\n\\end{alignat*}\n\nwhich, writing $y$ as a function of $x$ define two lines:\n\n1) $y = -\\frac{x}{4} + 2$\n2) $y = -\\frac{4x}{5} + \\frac{7}{5}$\n\nLet's plot these equations in `R` and see what they look like\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define some grid points to evaluate the line\nx <- seq(-2, 2, length = 1000)\ndat <- data.frame(\n    x = c(x, x),\n    y = c(-x / 4 + 2, - 4 / 5 * x + 7/5),\n    equation = factor(rep(c(1, 2), each = 1000))\n)\nglimpse(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,000\nColumns: 3\n$ x        <dbl> -2.000000, -1.995996, -1.991992, -1.987988, -1.983984, -1.979…\n$ y        <dbl> 2.500000, 2.498999, 2.497998, 2.496997, 2.495996, 2.494995, 2…\n$ equation <fct> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n\n```{.r .cell-code}\ndat %>%\n    ggplot(aes(x = x, y = y, color = equation, group = equation)) +\n    geom_line() +\n    scale_color_viridis_d(end = 0.8) +\n    # solution x = -12/11, y = 25/11\n    geom_point(aes(x = -12/11, y = 25/11), color = \"red\", size = 2) +\n    ggtitle(\"Linear system of equations\")\n```\n\n::: {.cell-output-display}\n![Linear system of equations with one solution](04-linear-systems-of-equations_files/figure-html/fig-onesolution-1.png){#fig-onesolution width=672}\n:::\n:::\n\n\nFrom this plot, it is clear that the solution to the system of equations is the location where the two lines intersect!\n:::\n\n\n**START BACK HERE WITH MORE EXAMPLES OF CANCELING VARIABLES**\n\n### Types of solutions\n\nTypically, there are 3 cases for the solutions to a system of linear equations\n\n1) There are no solutions\n2) There is one solution (@fig-onesolution)\n3) There are infinitely many solutions\n\n::: {#def-}\nA linear system of equations is called **consistent** if the system has either one or infinitely many solutions and is called **inconsistent** if the system has no solution.\n:::\n\n#### There are no solutions:\n\nConsider the system of linear equations\n\n\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 16 y & {}={} & 18.\n\\end{alignat*}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define some grid points to evaluate the line\nx <- seq(-2, 2, length = 1000)\ndat <- data.frame(\n    x = c(x, x),\n    y = c(-x / 4 + 8 / 4, - x / 4 + 18 / 4),\n    equation = factor(rep(c(1, 2), each = 1000))\n)\nglimpse(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,000\nColumns: 3\n$ x        <dbl> -2.000000, -1.995996, -1.991992, -1.987988, -1.983984, -1.979…\n$ y        <dbl> 2.500000, 2.498999, 2.497998, 2.496997, 2.495996, 2.494995, 2…\n$ equation <fct> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n\n```{.r .cell-code}\ndat %>%\n    ggplot(aes(x = x, y = y, color = equation, group = equation)) +\n    geom_line() +\n    scale_color_viridis_d(end = 0.8) +\n    # solution x = -12/11, y = 25/11\n    ggtitle(\"Linear system of equations\")\n```\n\n::: {.cell-output-display}\n![Linear system of equations with no solution](04-linear-systems-of-equations_files/figure-html/no-solution-1.png){width=672}\n:::\n:::\n\n\nIn this case, the linear equations are parallel lines and will never intersect so therefore there is no solution.\n\n<!-- Type out how to try and solve the system of equations -->\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nTo find if a solution to this equation exists, we can do some algebra and take 4 times the top equation and then subtract the bottom equation, replacing the bottom equation with this new sum like\n\n\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x  - 4(x) & {}+{} & 16 y - 4\\times (4 y) & {}={} & 18 - 4 \\times (8).\n\\end{alignat*}\nwhere the part of the equations in `()` is the top equation. This system of equations now simplifies to \n\\begin{alignat*}{3}\nx & {}+{} & 4 y & {}={} & 8 \\\\\n0 x & {}+{} &  0 y & {}={} & -14,\n\\end{alignat*}\n\n\nwhich gives $0 = -14$. From this, we see that we have reached a contradiction so there is not a solution to the system of equations.\n:::\n\n#### There is one solution:\n\nConsider the system of equations from @exm-exampleonesolution\n\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 5 y & {}={} & 7.\n\\end{alignat*}\n\nWhere we found that there was a unique solution $x = -\\frac{12}{11}$ and $y = \\frac{25}{11}$. While finding the solution can be done algebraically, what does this mean visually (geometrically)? The original equations were \n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 5 y & {}={} & 7,\n\\end{alignat*}\nwhich, writing $y$ as a function of $x$ define two lines:\n\n1) $y = -\\frac{x}{4} + 2$\n2) $y = -\\frac{4x}{5} + \\frac{7}{5}$\n\nLet's plot these equations in `R` and see what they look like\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define some grid points to evaluate the line\nx <- seq(-2, 2, length = 1000)\ndat <- data.frame(\n    x = c(x, x),\n    y = c(-x / 4 + 2, - 4 / 5 * x + 7/5),\n    equation = factor(rep(c(1, 2), each = 1000))\n)\nglimpse(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,000\nColumns: 3\n$ x        <dbl> -2.000000, -1.995996, -1.991992, -1.987988, -1.983984, -1.979…\n$ y        <dbl> 2.500000, 2.498999, 2.497998, 2.496997, 2.495996, 2.494995, 2…\n$ equation <fct> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n\n```{.r .cell-code}\ndat %>%\n    ggplot(aes(x = x, y = y, color = equation, group = equation)) +\n    geom_line() +\n    scale_color_viridis_d(end = 0.8) +\n    # solution x = -12/11, y = 25/11\n    geom_point(aes(x = -12/11, y = 25/11), color = \"red\", size = 2) +\n    ggtitle(\"Linear system of equations\")\n```\n\n::: {.cell-output-display}\n![Linear system of equations with one solution](04-linear-systems-of-equations_files/figure-html/onesolutionrevisited-1.png){width=672}\n:::\n:::\n\n\nFrom this plot, it is clear that the solution to the system of equations is the **point** where the two lines intersect!\n\n\n\n#### There are infinitely many solutions:\n\nConsider the system of linear equations\n\\begin{alignat*}{3}\nx   & {}+{} & 4 y & {}={} & 8 \\\\\n4 x & {}+{} & 16 y & {}={} & 32.\n\\end{alignat*}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define some grid points to evaluate the line\nx <- seq(-2, 2, length = 1000)\ndat <- data.frame(\n    x = c(x, x),\n    y = c(-x / 4 + 8 / 4, - 4 * x / 16 + 32 / 16),\n    equation = factor(rep(c(1, 2), each = 1000))\n)\nglimpse(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,000\nColumns: 3\n$ x        <dbl> -2.000000, -1.995996, -1.991992, -1.987988, -1.983984, -1.979…\n$ y        <dbl> 2.500000, 2.498999, 2.497998, 2.496997, 2.495996, 2.494995, 2…\n$ equation <fct> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n\n```{.r .cell-code}\ndat %>%\n    ggplot(aes(x = x, y = y, color = equation, group = equation)) +\n    geom_line() +\n    scale_color_viridis_d(end = 0.8) +\n    # solution x = -12/11, y = 25/11\n    ggtitle(\"Linear system of equations\")\n```\n\n::: {.cell-output-display}\n![Linear system of equations with no solution](04-linear-systems-of-equations_files/figure-html/infinite-solutions-1.png){width=672}\n:::\n:::\n\n\nIn this case, the linear equations are perfectly overlapping lines and always intersect so therefore there are infinitely many solutions (all points on the line).\n\n::: {#def-}\nTwo linear systems of equations are called **equivalent** if both systems share the same **solution set**.\n:::\n\nFor example, the system of equations\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 2 x_3 & {}={} & 9\n\\end{alignat*}\nand the system of equations\n\\begin{alignat*}{4}\n2x_1   & {}+{} & 8 x_2 & {}-{} & 2 x_3 & {}={} & 22 \\\\\n8 x_1 & {}+{} & 10 x_2 & {}+{} & 4 x_3 & {}={} & 18.\n\\end{alignat*}\nhave the same solution set (the second set of equations is just 2 times the first set of equations).\n\n\n::: {#exm-}\nFor the following system of equations, determine if a solution(s) exist and if so, solve for the solution\n\\begin{alignat*}{3}\n4 x_1 & {}+{} & 5 x_2 & {}={} & 8 \\\\\n9 x_1 & {}-{} & 3 x_2 & {}={} & 4.\n\\end{alignat*}\n:::\n\n\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nMultiply the first equation by $\\frac{1}{4}$ and the second equation by $\\frac{1}{9}$ to get \n\\begin{alignat*}{3}\nx_1 & {}+{} & \\frac{5}{4} x_2 & {}={} & 2 \\\\\nx_1 & {}-{} &  \\frac{1}{3}x_2 & {}={} & \\frac{4}{9}.\n\\end{alignat*}\nSubtract the first equation from the second equation\n\\begin{alignat*}{3}\nx_1 & {}+{} & \\frac{5}{4} x_2 & {}={} & 2 \\\\\n0 & {}-{} &  (-\\frac{1}{3} - \\frac{5}{4}) x_2 & {}={} & \\frac{4}{9} - 2,\n\\end{alignat*}\nwhich reduces to \n\\begin{alignat*}{3}\nx_1 & {}+{} & \\frac{5}{4} x_2 & {}={} & 2 \\\\\n0 & {}-{} &  -\\frac{19}{12} x_2 & {}={} & -\\frac{14}{9},\n\\end{alignat*}\nso that, dividing both sides of the second equation by $-\\frac{19}{12}$ gives $x_2 = \\frac{56}{57}$. Plugging this value of $x_2$ into the first equation gives\n\\begin{alignat*}{3}\nx_1 & {}+{} & \\frac{5}{4} \\left(\\frac{56}{57}\\right) & {}={} & 2 \\\\\n0 & {}-{} &   x_2 & {}={} & \\frac{56}{57}\n\\end{alignat*}\nand subtracting $\\frac{5}{4} \\frac{56}{57}$ from both sides of the first equation gives $x_1 = \\frac{44}{57}$. You can check these solutions by verifying that the following two equations hold\n\\begin{alignat*}{3}\n4 \\left(\\frac{44}{57}\\right) & {}+{} & 5  \\left(\\frac{56}{57}\\right) & {}={} & 8 \\\\\n9 \\left(\\frac{44}{57}\\right) & {}-{} & 3 \\left(\\frac{56}{57}\\right)& {}={} & 4\n\\end{alignat*}\nwhich can be done in `R` using\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx1 <- 44/57\nx2 <- 56/57\nall.equal(4 * x1 + 5 * x2, 8)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nall.equal(9 * x1 - 3 * x2, 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n:::\n\n::: {#exm-}\nFor the following system of equations, determine if a solution(s) exist and if so, solve for the solution\n\\begin{alignat*}{4}\n7 x_1 & {}+{} & 3 x_2 & {}+{} & 4 x_3 & {}={} & 5\\\\\n4 x_1 & {}-{} & 5 x_2 &&        & {}={} & -2\n\\end{alignat*}\n\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nMultiply the first equation by $\\frac{1}{7}$ and the second equation by $\\frac{1}{4}$ to get \n\\begin{alignat*}{4}\nx_1 & {}+{} & \\frac{3}{7} x_2 & {}+{} & \\frac{4}{7} x_3 & {}={} & \\frac{5}{7} \\\\\nx_1 & {}-{} & \\frac{5}{4} x_2 & {}+{} & 0 x_3       & {}={} & \\frac{-1}{2}.\n\\end{alignat*}\nSubtract the first equation from the second equation\n\\begin{alignat*}{4}\nx_1 & {}+{} & \\frac{3}{7} x_2 & {}+{} & \\frac{4}{7} x_3 & {}={} & \\frac{5}{7} \\\\\n0 x_1 & {}+{} &  (-\\frac{5}{4} - \\frac{3}{7}) x_2 &{}+{}& -\\frac{4}{7} x_3  & {}={} & - \\frac{1}{2} - \\frac{5}{7},\n\\end{alignat*}\nwhich reduces to \n\\begin{alignat*}{4}\nx_1 & {}+{} & \\frac{3}{7} x_2 & {}+{} & \\frac{4}{7} x_3 & {}={} & \\frac{5}{7} \\\\\n0 & {}-{} &  -\\frac{47}{28} x_2 &{}-{}& \\frac{4}{7} x_3 & {}={} & -\\frac{17}{14}.\n\\end{alignat*}\nNext, divide the second equation by $\\frac{-47}{28}$ gives \n\\begin{alignat*}{4}\nx_1 & {}+{} & \\frac{3}{7} x_2 & {}+{} & \\frac{4}{7} x_3 & {}={} & \\frac{5}{7} \\\\\n0 & {}+{} & x_2 &{}+{}& \\frac{16}{47} x_3 & {}={} & \\frac{34}{47}.\n\\end{alignat*}\nThen, take the first equation and subtract $-\\frac{3}{7}$ times the second row to get\n\\begin{alignat*}{4}\nx_1 & {}+{} & 0 x_2 & {}+{} & \\frac{20}{47} x_3 & {}={} & \\frac{19}{47} \\\\\n0 & {}+{} & x_2 &{}+{}& \\frac{16}{47} x_3 & {}={} & \\frac{34}{47},\n\\end{alignat*}\nwhich gives the solution\n$x_1 + \\frac{20}{47} x_3 = \\frac{19}{47}$, $x_2 + \\frac{16}{47} x_3 = \\frac{34}{47}$, and $x_3 = x_3$ is a free variable.\n\nThe solution can be checked in `R` using\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# this is a free variable, you can assign it any value\nx3 <- 3\nx1 <- 19/47 - 20/47 * x3\nx2 <- 34/47 - 16/47 * x3\n# check the first equation\nall.equal(7 * x1 + 3 * x2 + 4 * x3, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n# check the second equation\nall.equal(4 * x1 - 5 * x2 + 0 * x3, -2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n:::\n\n::: {#exm-}\nFor the following system of equations, determine if a solution(s) exist and if so, solve for the solution\n\\begin{alignat*}{3}\n4 x_1 & {}-{} & 2 x_2 & {}={} & 8\\\\\n2 x_1 & {}+{} & x_2 & {}={} & 7 \\\\\n-3 x_1 & {}+{} & 6 x_2 &{}={} & 11\n\\end{alignat*}\n\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nMultiply the first equation by $\\frac{1}{4}$, the second equation by $\\frac{1}{2}$, and the third equation by $-\\frac{1}{3}$ to get \n\\begin{alignat*}{3}\nx_1 & {}-{} & \\frac{1}{2} x_2 & {}={} & 2\\\\\nx_1 & {}+{} & \\frac{1}{2} x_2 & {}={} & \\frac{7}{2} \\\\\n x_1 & {}-{} & 2 x_2 &{}={} & -\\frac{11}{3}\n\\end{alignat*}\nSubtract the first equation from the second equation and also subtract the first equation from the third equation. Thus, we get\n\\begin{alignat*}{3}\nx_1 & {}-{} & \\frac{1}{2} x_2 & {}={} & 2\\\\\n0 x_1 & {}+{} & x_2 & {}={} & \\frac{3}{2} \\\\\n0 x_1 & {}-{} & \\frac{3}{2} x_2 &{}={} & -\\frac{17}{3}.\n\\end{alignat*}\nThen, multiply the third equation by $-\\frac{2}{3}$ to get\n\\begin{alignat*}{3}\nx_1 & {}-{} & \\frac{1}{2} x_2 & {}={} & 2\\\\\n0 x_1 & {}+{} & x_2 & {}={} & 3 \\\\\n0 x_1 & {}+{} & x_2 &{}={} & - \\frac{34}{9}.\n\\end{alignat*}\n\nNotice that the second equation gives $x_2 = 3$ while the third equation gives $x_2 = -\\frac{34}{9}$. This is a contradiction ($3 \\neq -\\frac{34}{9})$ which implies that the system of equations does not have a solution. Thus we say the system of equations is inconsistent.\n:::\n\n\n\n### Elementary row and column operations on matrices\n\nThe elementary row (column) operations include \n\n1) swaps: swapping two rows (columns),\n2) sums: replacing a row (column) by the sum itself and a multiple of another row (column)\n3) scalar multiplication: replacing a row (column) by a scalar multiple times itself\n\nNote that these operations are exactly what we used to solve the equation using algebra above (except for swapping rows).\n\n\n\n::: {#exm-}\nFor the elementary row operations listed above, we demonstrate these using the matrix\n\n::: {.cell}\n\n:::\n\n$$\n\\begin{aligned}\n\\begin{pmatrix} 1 & 4 & 7 \\\\ 2 & 5 & 8 \\\\ 3 & 6 & 9 \\end{pmatrix}\n\\end{aligned}\n$$\n\nThe matrix $\\mathbf{A}$ can be represented in `R` using\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\n```\n:::\n\n\n\n1) Swap the first and second rows. \n\n2) Add -3 times the first row to the third row.\n\n3) Multiply the second row by $\\frac{1}{2}$.\n:::\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\nHere we present examples of the elementary row operations \n\n1) Swap the first and second rows.\n\nThe matrix with the first and second rows swapped is \n\n\n::: {.cell}\n\n:::\n\n$$\n\\begin{aligned}\n\\begin{pmatrix} 2 & 5 & 8 \\\\ 1 & 4 & 7 \\end{pmatrix}\n\\end{aligned}\n$$\n\nNotice that the first and second rows have now switched places. This can be done in `R` in a variety of ways. First, we extract the rows and place them \"by hand\" in `R`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\n# extract the rows\nrow1 <- A[1, ] \nrow2 <- A[2, ]\n# swap the rows\nA[1, ] <- row2\nA[2, ] <- row1\nA\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    2    5    8\n[2,]    1    4    7\n[3,]    3    6    9\n```\n:::\n:::\n\nAnother way to do this is to use the function `rbind()` that binds rows together into a matrix. \n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\n# bind row 2, row 1, and row 3 togethter\nrbind(A[2, ], A[1, ], A[3, ])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    2    5    8\n[2,]    1    4    7\n[3,]    3    6    9\n```\n:::\n:::\n\nYet another way to swap the first two rows is to use a vectorized operation. This allows for fast and efficient coding and computing. The vectorized row swap is \n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\n# Take the 2nd, 1st, and 3rd row of A, in that order\nA[c(2, 1, 3), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    2    5    8\n[2,]    1    4    7\n[3,]    3    6    9\n```\n:::\n:::\n\n\n2) Add -3 times the first row to the third row.\n\n\n::: {.cell}\n\n:::\n\n\nFirst, we notice that -3 times the first row gives the row vector $\\begin{pmatrix} -3 & -12 & -21 \\end{pmatrix}$. Then, we add this to the row vector of the third row  $\\begin{pmatrix} 3 & 6 & 9 \\end{pmatrix}$ to get the row vector  $\\begin{pmatrix} 0 & -6 & -12 \\end{pmatrix}$. Finally, this row vector replaces the third row of the matrix to give the result\n$$\n\\begin{aligned}\n\\begin{pmatrix} 1 & 4 & 7 \\\\ 2 & 5 & 8 \\\\ 0 & -6 & -12 \\end{pmatrix}\n\\end{aligned}\n$$\n\n**Note:** Notice that by performing this row sum and replacement, we have made the first column of the third row of $\\mathbf{A}$ a 0. This zeroing out of the columns will play a very important role moving forward.\n\nUsing `R`, this can be done as\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\n# extract the rows \nrow1 <- A[1, ]\nrow3 <- A[3, ]\nA[3, ] <- -3 * row1 + row3\nA\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    1    4    7\n[2,]    2    5    8\n[3,]    0   -6  -12\n```\n:::\n:::\n\n\nAnother way to do this row sum and replacement is\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1:9), 3, 3, byrow = FALSE)\nA[3, ] <- -3 * A[1, ] + A[3, ]\nA\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    1    4    7\n[2,]    2    5    8\n[3,]    0   -6  -12\n```\n:::\n:::\n\n\n\n3) Multiply the second row by $\\frac{1}{2}$.\n\n\n::: {.cell}\n\n:::\n\n\nThe second row of $\\mathbf{A}$ is the row vector $\\begin{pmatrix} 2 & 5 & 8 \\end{pmatrix}$. Multiplying the second row by $\\frac{1}{2}$ gives the row vector $\\begin{pmatrix} 1 & 5/2 & 4 \\end{pmatrix}$. Plugging this into the matrix gives the full matrix with second row multiplied by $\\frac{1}{2}$ as \n$$\n\\begin{aligned}\n\\begin{pmatrix} 1 & 4 & 7 \\\\ 1 & 5/2 & 4 \\\\ 3 & 6 & 9 \\end{pmatrix}\n\\end{aligned}\n$$\nIn `R`, the second row of $\\mathbf{A}$ can be multiplied by $\\frac{1}{2}$ as\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA[2, ] <- 1/2 * A[2, ]\nA\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]\n[1,]    1  4.0    7\n[2,]    1  2.5    4\n[3,]    3  6.0    9\n```\n:::\n:::\n\n\n:::\n\n### The Augmented matrix form of a system of equations\n\nConsider the linear system of equations \n\n\\begin{alignat*}{4}\nx_1   & {}+{} & 4 x_2 & {}-{} & x_3 & {}={} & 11 \\\\\n4 x_1 & {}+{} & 5 x_2 & {}+{} & 2 x_3 & {}={} & 9.\n\\end{alignat*}\nThe augmented matrix representation of this system of linear equations is given by the matrix\n$$\n\\begin{aligned}\n\\begin{pmatrix}\n1 & 4 & - 1 & 11 \\\\\n4 & 5 & 2   &  9\n\\end{pmatrix},\n\\end{aligned}\n$$\nwhere the first column of the matrix represents the variable $x_1$, the second column of the matrix represents the variable $x_2$, the third column of the matrix represents the variable $x_3$, and the fourth column of the matrix represents the constant terms. We can express the augmented form in `R` using a matrix\n\n::: {.cell}\n\n```{.r .cell-code}\naugmented_matrix <- matrix(c(1, 4, 4, 5, -1, 2, 11, 9), 2, 4)\naugmented_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4]\n[1,]    1    4   -1   11\n[2,]    4    5    2    9\n```\n:::\n:::\n\nand to make clear the respective variables, we can add in column names as a matrix attribute using the `colnames()` function\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(augmented_matrix) <- c(\"x1\", \"x2\", \"x3\", \"constants\")\naugmented_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x1 x2 x3 constants\n[1,]  1  4 -1        11\n[2,]  4  5  2         9\n```\n:::\n:::\n\n\nwhich adds labels to each of the columns.\n\nNow, using elementary row operations on the matrix, we can attempt to find solutions to the system of equations. First, we multiply the first row by -4 and add it to the second row of the matrix and replace the second row with this sum\n\n::: {.cell}\n\n```{.r .cell-code}\naugmented_matrix[2, ] <- -4 * augmented_matrix[1, ] + augmented_matrix[2, ]\naugmented_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x1  x2 x3 constants\n[1,]  1   4 -1        11\n[2,]  0 -11  6       -35\n```\n:::\n:::\n\nNext, scale the second row to have a leading value of 1 by dividing by -11\n\n::: {.cell}\n\n```{.r .cell-code}\naugmented_matrix[2, ] <- augmented_matrix[2, ] / (-11)\naugmented_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x1 x2         x3 constants\n[1,]  1  4 -1.0000000 11.000000\n[2,]  0  1 -0.5454545  3.181818\n```\n:::\n:::\n\nWe can then multiply the second row by -4 and add it to the first row and replace the first row with this value.\n\n::: {.cell}\n\n```{.r .cell-code}\naugmented_matrix[1, ] <- augmented_matrix[1, ] - 4 * augmented_matrix[2, ]\naugmented_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x1 x2         x3 constants\n[1,]  1  0  1.1818182 -1.727273\n[2,]  0  1 -0.5454545  3.181818\n```\n:::\n:::\n\n\nNotice how the matrix has a \"triangular\" form (The lower part of the \"triangle\" is made of 0s and the upper part has numbers).\n\nThe triangular form tells us that There are infinitely many solutions to this system of equation. The infinite solutions are subject to the requirements that \n$$x_1 = - \\frac{19}{11} - \\frac{13}{11} x_3$$\nand\n$$x_2 = \\frac{35}{11} + \\frac{6}{11} x_3.$$\nTo get this into a reasonable form, we will solve these equations as a function of $x_1$. Solving the first equation for $x_3$ gives\n$$x_3 = - \\frac{19}{13} -\\frac{11}{13} x_1.$$\nThen, plugging this into $x_3$ in the second equation gives \n$$\n\\begin{aligned}\nx_2 & = \\frac{35}{11} + \\frac{6}{11} \\left( - \\frac{19}{13} -\\frac{11}{13} x_1 \\right) \\\\\n& = \\frac{341}{143} - \\frac{6}{13} x_1\n\\end{aligned}\n$$\nwhich defines a linear relationship between $x_1$ and $x_2$. Notice that in these last two solutions, $x_1$ is a \"free variable\" and $x_2$ and $x_3$ are \"determined\" by $x_1$. \n\n\nIn the plot below, the two planes (red and blue) are the geometric plots of the linear equations in the system of equations (the red plane is the top equation and the blue plane is the bottom equation). The purple line is the equation for the solution given the free variable $x_3$ and lies at the intersection of the two planes, much like the point in the two lines in figure **linking reference here** lies at the intersection of the two points. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# uses gg3D library\nn <- 60\nx1 <- x2 <- seq(-10, 10, length = n)\nregion <- expand.grid(x1 = x1, x2 = x2)\ndf <- data.frame(\n    x1 = region$x1,\n    x2 = region$x2,\n    x3 = - 11 + (region$x1 + 4 * region$x2)\n)\n\ndf2 <- data.frame(\n    x1 = region$x1,\n    x2 = region$x2,\n    x3 = (9 - 4 * region$x1 - 5 * region$x2) / 2\n) \n\ndf_solution <- data.frame(\n    x1 = x1, \n    x2 = 341 / 143 - 6 / 13 * x1,\n    x3 = -19/13 - 11/13 * x1\n) \n\n# theta and phi set up the \"perspective/viewing angle\" of the 3D plot\ntheta <- 63\nphi <- -12\nggplot(df, aes(x1, x2, z = x3)) +\n    axes_3D(theta = theta, phi = phi) +\n    stat_wireframe(alpha = 0.25, color = \"red\", theta = theta, phi = phi) +\n    stat_wireframe(data = df2, aes(x = x1, y = x2, z = x3), alpha = 0.25, color = \"blue\", theta = theta, phi = phi) +\n    stat_3D(data = df_solution, aes(x1, x2, z = x3), geom = \"line\", theta = theta, phi = phi, color = \"purple\") +\n    theme_void() +\n    theme(legend.position = \"none\") +\n    labs_3D(hjust=c(0,1,1), vjust=c(1, 1, -0.2), angle=c(0, 0, 90), theta = theta, phi = phi) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 row(s) containing missing values (geom_path).\nRemoved 2 row(s) containing missing values (geom_path).\n```\n:::\n\n::: {.cell-output-display}\n![](04-linear-systems-of-equations_files/figure-html/plot-solution-1.png){width=672}\n:::\n:::\n\n\n### Existence and Uniqueness\n\n::: {#def-}\nA system of linear equations is said to be consistent if at least one solution exists. The linear system of equations is said to have a **unique** solution if only one solution exists. \n:::\n\n::: {#exm-}\nIs the system of linear equations consistent? If the system is consistent, does it have a unique solution?\n\n\n\n::: {.cell}\n\n:::\n\n\n$$\n\\begin{alignedat}{4}  16 x_1 & {}+{} & 2 x_2 & {}+{} & 3 x_3 & {}={} & 13\\\\ 5 x_1 & {}+{} & 11 x_2 & {}+{} & 10 x_3 & {}={} & 8\\\\ 9 x_1 & {}+{} & 7 x_2 & {}+{} & 6 x_3 & {}={} & 12\\\\ 4 x_1 & {}+{} & 14 x_2 & {}+{} & 15 x_3 & {}={} & 1 \\end{alignedat}\n$$\n:::\n\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\\textbf{fill in solution here}\n:::\n\n\n\n::: {#exm-}\n\nIs the system of linear equations consistent? If the system is consistent, does it have a unique solution?\n\n\n::: {.cell}\n\n:::\n\n\n$$\n\\begin{alignedat}{4}   x_1 & {}+{} & 2 x_2 & {}+{} & 3 x_3 & {}={} & 5\\\\  x_1 & {}+{} & 3 x_2 & {}+{} & 2 x_3 & {}={} & 2\\\\ 3 x_1 & {}+{} & 2 x_2 & {}+{} &  x_3 & {}={} & 7 \\end{alignedat}\n$$\n:::\n\n<!-- Solution -->\n\n::: {.callout-note icon=false collapse=\"true\" appearance=\"simple\"} \n## Solution\n\\textbf{fill in solution here}\n:::\n\n\n## Reduce row echelon form\n\nReducing a matrix to row echelon form is a useful technique for working with matrices. The row echelon form can be used to solve systems of equations, as well as determine other properties of a matrix that are yet to be discussed, including rank, invertibility, column/row spaces, etc. \n\n\n::: {#def-}\n\nA matrix is said to be in **echelon** form if \n\n1) all nonzero rows are above any rows of zeros (all rows consisting entirely of zeros are at the bottom)\n\n2) the leading entry/coefficient of a nonzero row (called the **pivot**) is always *strictly* to the right of the leading entry/coefficient of the row above\n\n:::\n\n::: {#exm-}\n**echelon matrix example in class**\n:::\n\n\n::: {#def-}\nA matrix is in **reduced row echelon form** if it is in echelon form and\n\n1) the leading entry/coefficient of each row is 1\n\n2) The leading entry/coefficient of 1 is the only nonzero entry in its column.\n\n:::\n\n\n::: {#exm-}\n**rref matrix example in class**\n:::\n\n\n::: {#def-}\nEchelon matrices have the property of being **upper diagonal**. A matrix is said to be **upper diagonal** if all entries of the matrix at or above the diagonal are nonzero. \n:::\n\n* Example: **lower and non-lower diagonal matrices \n\n::: {#def-}\nTwo matrices are **row-equivalent** if one matrix can be transformed to the other through elementary row operations.\n:::\n\n::: {#thm-reducedechelon}\nA nonzero matrix can be transformed into more than one echelon forms. However, the reduced row echelon form of a nonzero matrix is unique.\n:::\n\n::: {#exm-echelonexample}\n\nUsing elementary row operations, calculate the reduced row echelon form of the following matrices\n\n1) **fill in later**\n\n2) **fill in later**\n\n3) **fill in later**\n\n:::\n\n### Pivot positions\n\nThe leading entry/coefficients of a row echelon form matrix are called pivots. The positions of the pivot positions are the same for any row echelon form of a matrix. In reduced row echelon form, these pivot positions take the value 1.\n\n::: {#def-}\nIn a matrix that is in reduced echelon form, the pivot position is the first nonzero element of each row. The column in which the pivot position occurs is called a pivot column.\n:::\n\n::: {#exm-}\n**pivot position and pivot columns**\n:::\n\n\n### Finding the reduced row echelon form\n\nCalculating the reduced row echelon form is known as Gaussian elimination, which is named after [Johann Carl Friedrich Gauss](https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss). This algorithm uses elementary row operations to calculate the reduced row echelon form. The following steps perform the Gaussian elimination algorithm.\n\n1) Start with the left-most nonzero column, which is a pivot column\n2) If the top row is zero, swap rows so that the top row is nonzero so that the top row has a nonzero element in the pivot position.\n3) Use row multiplication and addition to zero out all positions in the pivot column below the top row (pivot position).\n4) Ignore this top row and repeat steps 1-3 until there are no more nonzero rows to apply steps 1-3 on. At the end of this step, the matrix is in row echelon form.\n5) Starting at the right-most pivot column, use elementary row operations to zero out all positions above each pivot and to make each pivot position 1. At the end of this step, the matrix is in reduced row echelon form.\n\n\n::: {#exm-}\n**in class**\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pracma library\n# rref example in class\n```\n:::\n\n\n### Using reduced row echelon forms to solve systems of linear equations\n\nWhen a system of linear equations is expressed as an augmented matrix, the reduced row echelon form can be used to find solutions to those systems of equations. Consider the systems of equations\n\n::: {.cell}\n\n:::\n\n\n$$\n\\begin{alignedat}{4}  3 x_1 & {}+{} & 8 x_2 & {}-{} & 4 x_3 & {}={} & 6\\\\ 2 x_1 & {}-{} & 4 x_2 & {}-{} & 1 x_3 & {}={} & 8\\\\ 4 x_1 & {}+{} & 5 x_2 & {}{} &   & {}={} & 9 \\end{alignedat}\n$$\n\nwhich can be written in the augmented matrix form as\n$$\n\\begin{pmatrix} 3 & 8 & -4 & 6 \\\\ 2 & -4 & -1 & 8 \\\\ 4 & 5 & 0 & 9 \\end{pmatrix}\n$$\n\nIn `R`, this is the matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# define matrix\n```\n:::\n\nCalculating the reduced row echelon form, gives\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate rref of augmented matrix\n```\n:::\n\nwhich gives the solution ...\n\n::: {#exm-}\n* **calculate the RREF for the augmented matrix in the example above by hand**\n:::\n\n\n::: {#exm-}\nAnother example where we find a solution is\n\n$$\n\\begin{aligned}\n5 x_1 && + && 4 x_2 && - && 2 x_3 && = & 0 \\\\\n-3 x_1 && - && 2 x_2 && - && 4 x_3 && = & 1 \\\\\n\\end{aligned}\n$$\n\n**Do same steps**\n:::\n\n\n::: {#def-}\nIn a system of linear equations that is underdetermined (fewer equations than unknowns), the **determined/basic variables** are those variable that have a 1 in the respective columns when in reduced row echelon form (i.e., variables in a pivot position). The variables that are not in a pivot position are called **free variable**.\n:::\n\n\n::: {#exm-}\n**in class**\n:::\n\n\n### Existence and uniqueness from reduced row echelon form\n\nThe row echelon form is useful to determine if a system of linear equations is consistent (the system of equations has a solution). To check if a solution to a linear system of equations exists, convert the system of equations to an augmented matrix form. Then, reduce the augmented matrix to row echelon form using elementary matrix operations. As long as there is not an equation of the form \n$$\n0 = \\mbox{constant}\n$$\nfor some constant number not equal to 0, the system of linear equations is consistent. If the augmented matrix can be written in reduced row echelon form with no free variables, the solution to the linear system of equations is unique. These results give rise to the theorem\n\n:::{#thm-}\nA linear system of equations is consistent (has a solution) if the furthest right column (the constant column) is not a pivot column. If the system of equations is consistent, (i.e., the furthest right column is not a pivot column), the solution is unique if there are no free variables and there are infinitely many solutions if there is at least one free variable.\n:::\n\n* **Example: consistent system of equations**\n\n\n\n\n\n$\\begin{pmatrix} -7 & -9 & 7 & 8 \\\\ -4 & 0 & 6 & -6 \\\\ -10 & 3 & -8 & 5 \\end{pmatrix}$\n\n* **Example: inconsistent system of equations**\n\n\n\n\n\n\n$\\begin{pmatrix} -7 & 0 & -8 & -5 \\\\ -4 & 3 & 8 & -2 \\\\ -10 & 7 & -6 & 4 \\\\ -9 & 6 & 5 & 1 \\end{pmatrix}$\n\n\n\n\n\n\n\n",
    "supporting": [
      "04-linear-systems-of-equations_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}