{
  "hash": "cc2b253391a61e1475ce17a02073e1bc",
  "result": {
    "markdown": "# Matrix equations {#matrix-equation}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dasc2594)\nlibrary(gg3D)\n```\n:::\n\n\n\n\nHere we introduce the concept of the linear equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$. This equation is the most fundamental equation in all of statistics and data science. Given a matrix $\\mathbf{A}$ and a vector of constants $\\mathbf{b}$, the goal is to solve for the value (or values) of $\\mathbf{x}$ that are a solution to this equation. The equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ is a matrix representation of the system of linear equations\n\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} \\mathbf{x} & = \\mathbf{b} \\\\\n\\begin{pmatrix} \\mathbf{a}_1 & \\ldots & \\mathbf{a}_K \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ \\vdots \\\\ x_K \\end{pmatrix} & = \\mathbf{b} \\\\\nx_1 \\mathbf{a}_1 + \\ldots + x_K \\mathbf{a}_K & = \\mathbf{b} \\\\\n\\end{aligned}\n$${#eq-matrixequation}\n\n\n\n\nas long as the matrix $\\mathbf{A}$ has $n$ rows and $K$ columns and the vectors $\\mathbf{a}_k$ are $n$-dimensional.\n\n* **Example: in class**\n\n* **Example: in class**\n\n## Solutions of matrix equations\n\nBecause the matrix equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ is equivalent to a linear system of equations $x_1 \\mathbf{a}_1 + \\ldots + x_K \\mathbf{a}_K = \\mathbf{b}$, we can solve the matrix equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ by writing the equation in an augmented matrix form\n\n\n\n$$\n\\begin{aligned}\n\\begin{pmatrix} \\mathbf{a}_1 & \\ldots & \\mathbf{a}_K & \\mathbf{b} \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nand then reducing the matrix to reduced row echelon form. This gives rise to the theorem\n\n:::{#thm-}\nThe matrix equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$, the vector equation $x_1 \\mathbf{a}_1 + \\ldots + x_K \\mathbf{a}_K = \\mathbf{b}$, and the augmented matrix $\\begin{pmatrix} \\mathbf{a}_1 & \\ldots & \\mathbf{a}_K & \\mathbf{b} \\end{pmatrix}$ all have the same solution set.\n:::\n\n## Existence of solutions\nA solution to the matrix equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ exists if and only if $\\mathbf{b}$ is a linear combination of the columns of $\\mathbf{A}$. In other words, $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ has a solution if and only if $\\mathbf{b}$ is in the $\\mbox{span}\\{\\mathbf{a}_1, \\ldots, \\mathbf{a}_K\\}$.\n\n* **Example: in class** Let $\\mathbf{A} =\\ldots$ and $\\mathbf{b} = \\ldots$. Is the matrix equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ consistent?\n\n:::{#thm-}\nFor the $n \\times K$ matrix $\\mathbf{A}$, the following statements are equivalent:\n\na) For each $\\mathbf{b} \\in \\mathcal{R}^n$, the equation $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$ has at least one solution\n\nb) Each $\\mathbf{b} \\in \\mathcal{R}^n$ is a linear combination of the columns of $\\mathbf{A}$\n    \nc) The columns of $\\mathbf{A}$ span $\\mathcal{R}^n$\n    \nd) $\\mathbf{A}$ has $n$ pivot columns. ($\\mathbf{A}$ has a pivot in every row)\n\n:::\n\n## Matrix-vector multiplication\n\nTo calculate $\\mathbf{A} \\mathbf{x}$, we need to define matrix multiplication. The equivalence between the linear systems of equations $x_1 \\mathbf{a}_1 + \\ldots + x_K \\mathbf{a}_K = \\mathbf{b}$ and the matrix equation $\\mathbf{A} \\mathbf{x}$ gives a hint in how to do this. First, recall the definition of $\\mathbf{A}$ and $\\mathbf{x}$\n\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A} = \\begin{pmatrix}\na_{11} & a_{12} & \\ldots & a_{1K} \\\\\na_{21} & a_{22} & \\ldots & a_{2K} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n1} & a_{n2} & \\ldots & a_{nK} \\\\\n\\end{pmatrix} && \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ \\vdots \\\\ x_K \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nThe matrix product $\\mathbf{A}\\mathbf{x}$ is the linear system of equations\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A}  \\mathbf{x} & = \\begin{pmatrix}\na_{11} & a_{12} & \\ldots & a_{1K} \\\\\na_{21} & a_{22} & \\ldots & a_{2K} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n1} & a_{n2} & \\ldots & a_{nK} \\\\\n\\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ \\vdots \\\\ x_n \\end{pmatrix} \\\\\n& = x_1\\begin{pmatrix}\na_{11} \\\\ a_{21} \\\\ \\vdots \\\\ a_{n1} \n\\end{pmatrix} +\nx_2 \\begin{pmatrix}\na_{12} \\\\ a_{22} \\\\ \\vdots \\\\ a_{n2} \n\\end{pmatrix} +\n\\cdots + x_K \\begin{pmatrix}\na_{1K} \\\\ a_{nK} \\\\ \\vdots \\\\ a_{nK} \\end{pmatrix} \\\\\n& =  \\begin{pmatrix}\na_{11} x_1 + a_{12} x_2 + \\ldots + a_{1K} x_K \\\\\na_{21} x_1 + a_{22} x_2 + \\ldots + a_{2K} x_K \\\\\n\\vdots \\\\\na_{n1} x_1 + a_{n2} x_2 + \\ldots + a_{nK} x_K \\\\\n\\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nNotice that the first row of the last matrix above has the sum first row of the matrix $\\mathbf{A}$ multiplied by the corresponding elements in $\\mathbf{x}$ (i.e., first element $a_{11}$ of the first row of $\\mathbf{A}$ times the first element $x_1$ of $\\mathbf{x}$ plus the second, third, fourth, etc.). Likewise, this pattern holds for the second row, and all the other rows. This gives an algorithm for evaluating the product $\\mathbf{A} \\mathbf{x}$.\n\n::: {#def-}\nThe product $\\mathbf{A}\\mathbf{x}$ of a $n \\times K$ matrix $\\mathbf{A}$ with a $K$-vector $\\mathbf{x}$ is a $n$-vector where the $i$th element of $\\mathbf{A}\\mathbf{x}$ is the sum of the $i$th row of $\\mathbf{A}$ times the corresponding elements of the vector $\\mathbf{x}$\n:::\n\n* **Example: in class**\n\n* **Example: in class**\n\n* **Example: in R using loops**\n\n* **Example: in R using `%*%`**\n\n## Properties of matrix-vector multiplication\n\nIf $\\mathbf{A}$ is a $n \\times K$ matrix, $\\mathbf{u}$ and $\\mathbf{v}$ are vectors in $\\mathcal{R}^K$ and $c$ is a scalar, then\n\na) $\\mathbf{A} (\\mathbf{u} + \\mathbf{v}) = \\mathbf{A} \\mathbf{u} + \\mathbf{A} \\mathbf{v}$\nb) $\\mathbf{A} (c \\mathbf{u}) = (c \\mathbf{A}) \\mathbf{u}$\n\n* **Proof in class**\n\n## Solutions of linear systems\n\n### Homogeneous linear systems of equations\n\n::: {#def-}\nThe matrix equation \n\n\n\n$$\n\\begin{aligned}\n\\mathbf{A}\\mathbf{x} = \\mathbf{0}\n\\end{aligned}\n$${#eq-homogeneous}\n\n\n\nis called a homogeneous system of equations. The vector $\\mathbf{0}$ is a vector of length $N$ composed of all zeros. The **trivial** solution of the homogeneous equation is when $\\mathbf{x} = \\mathbf{0}$ and is not a very useful solution. Typically one is interested in **nontrivial** solutions where $\\mathbf{x} \\neq \\mathbf{0}$.\n:::\n\nThe homogeneous linear system of equations can be written in augmented matrix form \n\n\n\n$$\n\\begin{aligned}\n\\begin{pmatrix} \\mathbf{a}_1 & \\ldots & \\mathbf{a}_K & \\mathbf{0} \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nwhich implies that a non-trivial solution only exists if there is a free variable. Another way of saying this is that at least one column $\\mathbf{A}$ must not be a pivot column (Note: the last column of the augmented matrix will not be a pivot column because it will be a column of zeros). If every column of $\\mathbf{A}$ were a pivot column, the reduced row echelon form of the augmented matrix would be \n\n\n\n$$\n\\begin{aligned}\n\\begin{pmatrix}\n1 & 0 & \\ldots & 0 & 0 \\\\\n0 & 1 & \\ldots & 0 & 0 \\\\\n0 & 0 & \\ldots & 1 & 0 \n\\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nwhich implies the only solution is the trivial solution $\\mathbf{0}$.\n\n* **Example: in class**\n\n\n\n\n$$\n\\begin{aligned}\n3 x_1 - 2 x_2 + 4 x_3 = 0 \\\\\n- 2 x_1 + 4 x_2 - 2 x_3 = 0 \\\\\n5 x_1 - 6 x_2 + 6 x_3 = 0\n\\end{aligned}\n$$\n\n\n\n* **Example: in class**\n\nConsider the equation\n\n\n\n\n$$\n\\begin{aligned}\n2x_1 + 4 x_2 - x_3 = 0.\n\\end{aligned}\n$$\n\n\n\nwe can write this as \n\n\n\n$$\n\\begin{aligned}\nx_1 = -2 x_2 + \\frac{1}{2} x_3\n\\end{aligned}\n$$\n\n\n\nwhere $x_2$ and $x_3$ are free variables. Writing this as a solution $\\mathbf{x}$ gives\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} -2 x_2 + \\frac{1}{2} x_3 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \nx_2 \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} + \nx_3 \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ 1 \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\nwhich is a linear combination of the vectors $\\mathbf{u} = \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix}$ and $\\mathbf{v} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ 1 \\end{pmatrix}$. This implies that we can write the solution $\\mathbf{x} = c \\mathbf{u} + d \\mathbf{v}$ for scalars $a$ and $b$. Therefore, the solution set $\\mathbf{x}$ is contained in the $\\mbox{span}\\{\\mathbf{u}, \\mathbf{v}\\}$. Because the vectors $\\mathbf{u}$ and $\\mathbf{v}$ are linearly independent (they don't point in the same direction), the set of all linear combinations of $c \\mathbf{u} + d \\mathbf{v}$ defines a plane. \n\n::: {#def-}\n A solution set of the form  $\\mathbf{x} = c \\mathbf{u} + d \\mathbf{v}$ is called a **parametric vector solution**.\n:::\n\n\n\n## Solutions to nonhomogeneous systems\n\nRecall the simple linear equation\n\n\n\n$$\ny = mx + b\n$$\n\n\n\nwhere $m$ is the slope and $b$ is the y-intercept. Setting $b = 0$ gives a simple homogenous linear equation where the y-intercept goes through the origin (0, 0). When $b$ is nonzero, the line keeps the same slope but is shifted upward/downward by $b$. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data.frame(x = 0, y = 0), aes(x, y)) +\n    geom_vline(xintercept = 0) +\n    geom_hline(yintercept = 0) +\n    geom_abline(slope = 2, intercept = 0, color = \"red\") +\n    geom_abline(slope = 2, intercept = 2, color = \"blue\") +\n    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4))  +\n    geom_text(\n        data = data.frame(x = c(0, 0), y = c(0, 2), text = c(\"homogeneous\\nsolution\", \"inhomogeneous\\nsolution\")),\n        aes(x = x + c(1.75, -1), y = y + 0.5, label = text), size = 5, inherit.aes = FALSE,\n        color = c(\"red\", \"blue\")) +\n    geom_segment(\n        aes(x = 0, xend = 0, y = 0, yend = 2),\n        arrow = arrow(length = unit(0.1, \"inches\")), \n        size = 1.5, color = \"orange\") +\n    geom_text(\n        data = data.frame(x = 0, y = 2, text = \"b\"),\n        aes(x = x + 0.5, y = y, label = text), \n        size = 8, inherit.aes = FALSE,\n        color = \"orange\") \n```\n\n::: {.cell-output-display}\n![](05-matrix-equations_files/figure-epub/plot-inhomogeneous-1.png)\n:::\n:::\n\n\n\n\nThis shift in location (but not in slope) is called a **translation**\n\n* **Example:** Show this shift for a system of linear equations where the solution set defines a plane. From example above, \n\n\n\n$$\n\\begin{aligned}\n2x_1 + 4 x_2 - x_3 = 0.\n\\end{aligned}\n$$\n\n\n\nhas the parametric solution $\\mathbf{x} = c \\mathbf{u} + d \\mathbf{v}$ with\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{u} & = \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} &\n\\mathbf{v} & = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ 1 \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\n\nNow, if we change the system of linear equations so that we have the inhomogeneous equation\n\n\n\n$$\n\\begin{aligned}\n2x_1 + 4 x_2 - x_3 = 20.\n\\end{aligned}\n$$\n\n\n\nwe get the homogeneous solution set $x_1 = -2 x_2 + \\frac{1}{2} x_3 + 10$ which can be written in parametric form as $\\mathbf{x} = c \\mathbf{u} + d \\mathbf{v} + \\mathbf{p}$ with\n\n\n\n$$\n\\begin{aligned}\n\\mathbf{u} & = \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} & \n\\mathbf{v} & = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ 1 \\end{pmatrix} & \n\\mathbf{p} & = \\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix}\n\\end{aligned}\n$$\n\n\n\n\nFor plotting, we will solve these equations for $x_3$, letting $x_1$ and $x_2$ be free variables (this is just for the requirements of the plotting function). Thus, the homogeneous equation has the solution $x_3 = 2x_1 + 4x_2$ and the inhomogenous equation has the solution $x_3 = 2x_1 + 4x_2 - 20$.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# uses gg3D library\nn <- 60\nx1 <- x2 <- seq(-10, 10, length = n)\nregion <- expand.grid(x1 = x1, x2 = x2)\ndf <- data.frame(\n    x1 = region$x1,\n    x2 = region$x2,\n    x3 = c(\n        2 * region$x1 + 4 * region$x2,\n        2 * region$x1 + 4 * region$x2 - 20),\n    equation = rep(c(\"inhomogeneous\", \"homogeneous\"), each = n^2))\n\n# theta and phi set up the \"perspective/viewing angle\" of the 3D plot\ntheta <- 45\nphi <- 20\nggplot(df, aes(x = x1, y = x2, z = x3, color = equation)) +\n    axes_3D(theta = theta, phi = phi) +\n    stat_wireframe(\n        alpha = 0.75,\n        theta = theta, phi = phi) +\n    scale_color_manual(values = c(\"inhomogeneous\" = \"blue\", \"homogeneous\" = \"red\")) +\n    theme_void() +\n    labs_3D(hjust=c(0,1,1), vjust=c(1, 1, -0.2), \n            angle=c(0, 0, 90), theta = theta, phi = phi) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 row(s) containing missing values (geom_path).\n```\n:::\n\n::: {.cell-output-display}\n![](05-matrix-equations_files/figure-epub/plot-parallel-planes-1.png)\n:::\n:::\n\n\n\n\n\n* **Example: in class** \nLet's revisit the example from before\n\n\n\n\n$$\n\\begin{aligned}\n3 x_1 - 2 x_2 + 4 x_3 = 0 \\\\\n- 2 x_1 + 4 x_2 - 2 x_3 = 0 \\\\\n5 x_1 - 6 x_2 + 6 x_3 = 0\n\\end{aligned}\n$$\n\n\n\nbut change this so that $\\mathbf{b} = \\begin{pmatrix} 2 \\\\ -6 \\\\ 8 \\end{pmatrix}$\n\n* **Write this as a parametric solution with a mean shift**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(3, -2, 5, -2, 4, -6, 4, -2, 6, 2, -6, 8), 3, 4)\nrref(A)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3]  [,4]\n[1,]    1    0 1.50 -0.50\n[2,]    0    1 0.25 -1.75\n[3,]    0    0 0.00  0.00\n```\n:::\n:::\n\n$$\n\\begin{aligned}\nx_1 = \\frac{3}{2} x_2  - \\frac{1}{2}\\\\\nx_2 = \\frac{1}{4} x_3  - \\frac{7}{4} \\\\\n\\end{aligned}\n$$\n\n\n\nwhich was the same solution set as the homoegenous solution plus the additional vector $\\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{7}{4} \\\\ 0 \\end{pmatrix}$. Thus, the inhomogenous solution is now $\\mathbf{x} = c \\mathbf{u} + d \\mathbf{v} + \\mathbf{p}$ where \n\n\n\n$$\n\\begin{aligned}\n\\mathbf{u} &= \\begin{pmatrix} 1 \\\\ 0 \\\\ \\frac{3}{2} \\end{pmatrix} & \n\\mathbf{v} &= \\begin{pmatrix} 0 \\\\ 1 \\\\ \\frac{1}{4} \\end{pmatrix} & \n\\mathbf{p} &= \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{7}{4} \\\\ 0 \\end{pmatrix} \n\\end{aligned}\n$$\n\n\n\n\n## Finding solutions\n\nThe following algorithm describes how to solve a linear system of equations.\n\n1) Put the system of equations in an augmented matrix form\n\n2) Reduce the augmented matrix to reduced row echelon form\n\n3) Express each determined variable as a function of the free variables. \n\n4) Write the solution in a general form where the determined variables are a function of the independent variables\n\n5) Decompose the solution $\\mathbf{x}$ into a linear combination of free variables as parameters\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "05-matrix-equations_files/figure-epub"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": {},
    "postProcess": true
  }
}