# Vectors spaces {#vector-spaces}

```{r}
library(shiny)
library(patchwork)
# if gg3D package not installed, install the package
library(gg3D)
library(dasc2594)
```

## Vectors 

For notation, we let lowercase Roman letters represent scalar numbers (e.g., n = 5, d = 7), lowercase bold letters represent vectors 

$$
\begin{align*}
\textbf{x} = \begin{pmatrix}  x_1 \\ x_2 \\ \vdots \\ x_n \end{pmatrix},
\end{align*}
$$

where the elements $x_1, \ldots, x_n$ are scalars written in lowercase Roman. Note that vectors are assumed to follow a vertical notation where the elements of the vector (the $x_i$s are stacked on top of one another) and the order matters. For example, the vector 

$$
\begin{align*}
\mathbf{x} & = \begin{pmatrix} 5 \\ 2 \\ 8 \end{pmatrix}
\end{align*}
$$

has the first element $x_1 = 5$, second element $x_2 = 2$ and third element $x_3 = 8$. Note that the vector $\begin{pmatrix}  5 \\ 2 \\ 8 \end{pmatrix}$ is not the same as the vector $\begin{pmatrix}  8 \\ 2 \\ 5 \end{pmatrix}$ because the order of the elements matters.

We can also write the vector as  

$$
\begin{align*}
\textbf{x} = \left(  x_1, x_2, \ldots, x_n \right)',
\end{align*}
$$

where the $'$ symbol represents the transpose function. For our example matrix, we have $\begin{pmatrix}  5 \\ 2 \\ 8 \end{pmatrix}' = \begin{pmatrix} 5 & 2 & 8 \end{pmatrix}$ which is the original vector but arranged in a row rather than a column. Likewise, the transpose of a row vector $\begin{pmatrix} 5 & 2 & 8 \end{pmatrix}' = \begin{pmatrix}  5 \\ 2 \\ 8 \end{pmatrix}$ is a column vector. If $\mathbf{x}$ is a column vector, we say that $\mathbf{x}'$ is a row vector and if $\mathbf{x}$ is a row vector, the $\mathbf{x}'$ is a column vector. 


To create a vector we can use the concatenate function `c()`. For example, the vector $\mathbf{x} = \begin{pmatrix}  5 \\ 2 \\ 8 \end{pmatrix}$ can be created as the `R` object using

```{r}
x <- c(5, 2, 8)
```

where the `<-` assigns the values in the vector `c(5, 2, 8)` to the object named `x`. To print the values of `x`, we can use

```{r}
x
```

which prints the elements of x. Notice that `R` prints the elements of $\mathbf{x}$ in a row; however, $\mathbf{x}$ is a column vector. This inconsistency is present to allow the output to be printed in a manner easier to read (more numbers fit on a row). If we put the column vector into a `data.frame`, then the vector will be presented as a column vector

```{r}
data.frame(x)
```

One can use the index operator $[\hspace{2mm}]$ to select specific elements of the vector $\mathbf{x}$. For example, the first element of $\mathbf{x}$, $x_1$, is

```{r}
x[1]
```

and the third element of $\mathbf{x}$, $x_3$, is

```{r}
x[3]
```

The transpose function `t()` turns a column vector into a row vector (or a row vector into a column vector). For example the transpose $\mathbf{x}'$ of $\mathbf{x}$ is 

```{r}
tx <- t(x)
tx
```

where `tx` is `R` object storing the transpose of $\mathbf{x}$ and is a row vector. The transpose of `tx`. Notice the indices on the output of the row vector `tx`. The index operator `[1, ]` selects the first row to `tx` and the index operator `[, 1]` gives the first column `tx`. Taking the transpose again gives us back the original column vector

```{r}
t(tx)
```


### Properties of Vectors

For any real valued scalars $a, b \in \mathcal{R}$ and any vectors $\mathbf{x}, \mathbf{y}, \mathbf{z} \in \mathcal{R}^n$ (vectors of real numbers of length $n$), 

1) **scalar multiplication**
$$
\begin{align*}
a \mathbf{x} & = a \begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{pmatrix} \\
& = \begin{pmatrix} a x_1 \\ a x_2 \\ \vdots \\ a x_n \end{pmatrix} 
\end{align*}
$$
    
where the scalar $a$ is multiplied by each element of the vector. For example, 

$$
\begin{align*}
4 \begin{pmatrix} 4 \\ 6 \\ 7 \\ 12 \end{pmatrix} 
& = \begin{pmatrix} 4 * 4 \\ 4 * 6 \\ 4 * 7 \\ 4 * 12 \end{pmatrix} \\
& = \begin{pmatrix} 16 \\ 24 \\ 28 \\ 48 \end{pmatrix} 
\end{align*}
$$

In `R`, we can multiply the vector by a scalar as

```{r}
4 * c(4, 6, 7, 12)
```

or if the vector $\mathbf{x} = \left( 4, 6, 7, 12 \right)'$ we can write this as

```{r}
x <- c(4, 6, 7, 12)
4 * x
```

2) **scalar multiplicative commutivity**

$$
\begin{align*}
a (b \mathbf{x}) & = (ab) \mathbf{x} & = b (a \mathbf{x})
\end{align*}
$$
    
```{r}
4 * (6 * x) 
(4 * 6) * x
```

3) **scalar additive associativity**

$$
\begin{align*}
a \mathbf{x} + b \mathbf{x} & = (a + b) \mathbf{x}
\end{align*}
$$

4) **vector additive associativity**

$$
\begin{align*}
a \mathbf{x} + a \mathbf{y} & = a (\mathbf{x} + \mathbf{y})
\end{align*}
$$
    
5) **vector associativity**
$$
\begin{align*}
\mathbf{x} + \mathbf{y} & = \mathbf{y} + \mathbf{x}
\end{align*}
$$

$$
\begin{align*}
(\mathbf{x} + \mathbf{y}) + \mathbf{z} & = \mathbf{x} + (\mathbf{y} + \mathbf{z})
\end{align*}
$$


```{r}
x <- c(1, 2, 3, 4)
y <- c(4, 3, 5, 1)
z <- c(5, 2, 4, 6)

x + y
y + x

(x + y) + z
x + (y + z)
```

6) **Identity Element of Addition:** For any vector $\mathbf{x}$ of length $n$, there exists a vector $\mathbf{0}$, known as the *zero vector*, such that

$$
\begin{align*}
\mathbf{x} + \mathbf{0} & = \mathbf{x}
\end{align*}
$$

```{r}
x + 0
x + rep(0, 4)
```

7) **Inverse Element of Addition:** For any vector $\mathbf{x}$ of length $n$, there exists a vector $-\mathbf{x}$, known as the *additive inverse* vector, such that

$$
\begin{align*}
\mathbf{x} + (- \mathbf{x}) & = \mathbf{0}
\end{align*}
$$

```{r}
x + (-x)
```


    
## Vector addition
Two vectors of length $n$ can be added elementwise

$$
\begin{align*}
\mathbf{x} + \mathbf{y} & = \begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{pmatrix} + \begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{pmatrix} \\
& = \begin{pmatrix} x_1 + y_1 \\ x_2 + y_2 \\ \vdots \\ x_n + y_n \end{pmatrix} 
\end{align*}
$$

For example, 

$$
\begin{align*}
\begin{pmatrix} 3 \\ 1 \\ -4 \\ 3 \end{pmatrix} + \begin{pmatrix} -3 \\ 17 \\ -39 \\ 4 \end{pmatrix} & = \begin{pmatrix} 3 + (-3) \\ 1 + 17 \\ -4 + (-39) \\ 3 + 4 \end{pmatrix} \\
& = \begin{pmatrix} 0 \\ 18 \\ -43 \\ 7 \end{pmatrix} 
\end{align*}
$$

In `R`, we have

```{r}
x <- c(3, 1, -4, 3)
y <- c(-3, 17, -39, 4)
x + y
``` 

If two vectors $\mathbf{x}$ and $\mathbf{y}$ are of different lengths, then they cannot be added together. Using `R`, we get the following error:

```{r}
x <- c(1, 2, 3)
y <- c(1, 2, 3, 4)
x + y
``` 

The error is telling us that the vector $\mathbf{x}$ and the vector $\mathbf{y}$ do not have the same length. 

Be careful when adding vectors in `R`. `R` uses "recycling" which means two vectors of different lengths can be added together if one vector is of a length that is a multiple of the other vector. For example, if $\mathbf{x} = (1, 2)'$ is a vector of length 2 and $\mathbf{y} = (1, 2, 3, 4)$ is a vector of length 4, `R` will add $\mathbf{x} + \mathbf{y}$ by replicating the vector $\mathbf{x}$ twice (i.e., $\mathbf{x} + \mathbf{y} = \left( \mathbf{x}', \mathbf{x}' \right)' = \left(1, 2, 1, 2 \right)' + \mathbf{y}$) 

```{r}
x <- c(1, 2)
y <- c(1, 2, 3, 4)
x + y
# replicated x = c(1, 2, 1, 2)
c(1, 2, 1, 2) + y
```

### The geometric interpretation of vectors in $\mathcal{R}^2$

Let $\mathcal{R}^2$ be a real coordinate space of $2$ dimensions. You are already familiar with the Cartesian plane that consists of ordered pairs $(x, y)$. The Cartesian plane defines the real coordinate space $\mathbf{R}^2$ of two dimensions. In $\mathbf{R}^2$, the location of any point of interest can be defined using the $x$ and $y$. For example, the plot below shows the location of the point (2, 3)

```{r}
dat <- data.frame(
    x = 2,
    y = 3
)

ggplot(data = dat, aes(x = x, y = y)) +
    geom_point() +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4))
```

A vector space is a generalization of this representation. In $\mathcal{R}^2$, we say that the vector $\mathbf{z} = c(2, 3)$ is centered at the origin (0, 0) and has length 2 in the $x$-axis and length 3 in the $y$-axis. The plot below shows this vector

```{r, echo = FALSE}
ggplot(data = dat, aes(x = x, y = y)) +
    geom_segment(aes(x = 0, xend = x, y = 0, yend = y), arrow = arrow()) +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4))
```

We can also decompose the vector $\mathbf{z}$ into its $x$ and $y$ components. The $x$ component of $\mathbf{z}$ is (2, 0) and the $y$ component of $\mathbf{z}$ is (0, 3). The following plot shows the $x$ component (2, 0) in blue and the $y$ component (0, 3) in red.

```{r, echo = FALSE}
ggplot(data = dat, aes(x = x, y = y)) +
    geom_segment(aes(x = 0, xend = x, y = 0, yend = y), arrow = arrow()) +
    geom_segment(aes(x = 0, xend = x, y = 0, yend = 0), arrow = arrow(), color = "blue") +
    geom_segment(aes(x = 0, xend = 0, y = 0, yend = y), arrow = arrow(), color = "red") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4))
```


The below Shiny app allows you to plot the vector for any $(x, y)$ pair of your choosing.

```{r, echo = FALSE, eval = FALSE}
library(shiny)
runGitHub(rep = "multivariable-math", username = "jtipton25", subdir = "shiny-apps/chapter-03/vector-space") 
```

The shiny app can be downloaded and run on your own computer using 

```{r, eval = FALSE}
library(shiny)
runGitHub(rep = "multivariable-math", username = "jtipton25", subdir = "shiny-apps/chapter-03/vector-space") 
```

#### Addition of vectors

We can represent the addition of vectors geometrically as well. Consider the two vectors $\mathbf{u}$ = (3, 2) and $\mathbf{v}$ = (-2, 1) where $\mathbf{u} + \mathbf{v}$ = (1, 3).

```{r}
data.frame(x = c(3, -2, 1), y = c(2, 1, 3), vector = c("u", "v", "u+v")) %>%
    ggplot() +
    geom_point(aes(x = x, y = y, color = vector)) +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4))
```

We can represent the sum using vectors by adding $\mathbf{u}$ first then adding $\mathbf{v}$ to $\mathbf{u}$ or by adding $\mathbf{v}$ first and then $\mathbf{u}$ to get

```{r}
df <- data.frame(x = c(0, 3, 1, -2), y = c(0, 2, 3, 1))
p1 <- ggplot() +
    geom_segment(aes(x = 0, xend = 3, y = 0, yend = 2), arrow = arrow(), color = "blue") +
    geom_segment(aes(x = 3, xend = 3 - 2, y = 2, yend = 2 + 1), arrow = arrow(), color = "red") +
    geom_segment(aes(x = 0, xend = 3 - 2, y = 0, yend = 2 + 1), arrow = arrow(), color = "black") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4)) + 
    geom_polygon(data = df, aes(x = x, y = y), fill = "grey", alpha = 0.5) +
    ggtitle("u + v")
p2 <- ggplot() +
    geom_segment(aes(x = 0, xend = -2, y = 0, yend = 1), arrow = arrow(), color = "red") +
    geom_segment(aes(x = -2, xend = -2 + 3, y = 1, yend = 1 + 2), arrow = arrow(), color = "blue") +
    geom_segment(aes(x = 0, xend = 3 - 2, y = 0, yend = 2 + 1), arrow = arrow(), color = "black") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4)) +
    geom_polygon(data = df, aes(x = x, y = y), fill = "grey", alpha = 0.5) +
    ggtitle("v + u")
p1 + p2
```

Notice that the sum of these vectors defines a parallelogram where the sum $\mathbf{u} + \mathbf{v}$ is the diagonal of the shaded parallelogram. This geometric interpretation will serve as a basis for interpreting vector equations in higher dimensions where typical visualization methods fail.

### Scalar multiplication of vectors


We can represent the multiplication of a vector by a scalar geometrically as well. Consider the vector $\mathbf{u}$ = (3, 2) and the scalars $a = 2$ and $b = -1$. Then, we can plot $\mathbf{u}$, $a\mathbf{u}$, and $b\mathbf{u}$.

```{r}
data.frame(x = c(3, 2 * 3, -1 * 3), y = c(2, 2 * 2, -1 * 2), vector = c("u", "a*u", "b*u")) %>%
    ggplot() +
    geom_point(aes(x = x, y = y, color = vector)) +
    geom_segment(aes(x = 0, xend = x, y = 0, yend = y, color = vector), arrow = arrow(), alpha = 0.75) +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-6, 6), ylim = c(-6, 6))
```

In fact, if $a$ is allowed to take on any values, then the set of all possible values of $a \mathbf{u}$ for all values of $a$ defines an infinite line

```{r}
ggplot() +
    geom_abline(slope = 2/3, intercept = 0) +  
    geom_point(aes(x = 3, y = 2)) +
    geom_segment(aes(x = 0, xend = 3, y = 0, yend = 2), arrow = arrow(), color = "black") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4)) 
```


### The geometric interpretation of vectors in $\mathcal{R}^3$

Let the vector $\mathbf{u} = c(-2, 3, 5)$. Then, the figure below shows the vector in 3 dimensions.

**Draw picture by hand**
```{r, echo = FALSE}
# # uses gg3D library
# u <- c(-2, 3, 5)
# theta <- NULL
# phi <- NULL
# data.frame(x = u[1], y = u[2], z = u[3]) %>%
#     ggplot( aes(x = x, y = y, z = z, group = 1)) +
#     axes_3D(theta = theta, phi = phi) +
#     stat_3D(aes(x = x, y = y, z = z), geom = "line", theta = theta, phi = phi) +
#     theme_void() +
#     labs_3D(hjust=c(0,1,1), vjust=c(1, 1, -0.2), angle=c(0, 0, 90), theta = theta, phi = phi) 
# data.frame(x = u[1], y = u[2], z = u[3]) %>%
#     ggplot( aes(x = x, y = y, z = z, group = 1)) +
#     axes_3D() +
#     stat_3D(aes(x = x, y = y, z = z, group = "1"), geom = "line") +
#     theme_void() +
#     labs_3D(hjust=c(0,1,1), vjust=c(1, 1, -0.2), angle=c(0, 0, 90))
```

### The geometric interpretation of vectors in $\mathcal{R}^n$

As the number of dimensions increases, the same interpretation can be used, but the ability to visualize higher dimensions becomes more difficult.


### Linear Combinations of Vectors

We say that for any two scalars $a$ and $b$ and any two vectors $\mathbf{x}$ and $\mathbf{y}$ of length $n$, the sum

$$
\begin{align*}
a \mathbf{x} + b \mathbf{y} & = \begin{pmatrix}
a x_1 + b y_1 \\
a x_2 + b y_2 \\
\vdots \\
a x_n + b y_n \\
\end{pmatrix}
\end{align*}
$$

is called a linear combination. The idea of a linear combination can be extended to $K$ different scalars $\{ a_1, \ldots, a_K \}$ and $K$ different vectors $\{ \mathbf{x}_1, \ldots, \mathbf{x}_K\}$ each of length $n$ as

$$
 \begin{align*}
a_1 \mathbf{x}_1 + a_2 + \mathbf{x}_2 +  \ldots + a_K \mathbf{x}_K = 
\sum_{k=1}^K a_k \mathbf{x}_k & = \begin{pmatrix}
\sum_{k=1}^K a_k x_{k1} \\
\sum_{k=1}^K a_k x_{k2} \\
\vdots \\
\sum_{k=1}^K a_k x_{kn} \\
\end{pmatrix}
\end{align*}
$$
The scalars $a_k$ are called **coefficients** (sometimes also called **weights**). 

* **Example:** Consider the linear combination $a \mathbf{u} + b \mathbf{v}$ where 

$$
\begin{align*}
\mathbf{u} = \begin{pmatrix} 3 \\ 6\end{pmatrix} && \mathbf{v} = \begin{pmatrix} -2 \\ 1\end{pmatrix}. \end{align*}
$$
Are there values of $a$ and $b$ such $a \mathbf{x}_1 + b \mathbf{x}_2 = \begin{pmatrix} 9 \\ - 4 \end{pmatrix}$? To answer this question, we can write the linear combination as 
$$
\begin{align*}
a \begin{pmatrix} 3 \\ 6\end{pmatrix} + b \begin{pmatrix} -2 \\ 1\end{pmatrix} & = \begin{pmatrix} 9 \\ -4 \end{pmatrix} 
\end{align*}
$$
which can be written using the property of scalar multiplication as
$$
\begin{align*}
\begin{pmatrix} 3a \\ 6a \end{pmatrix} + \begin{pmatrix} -2b \\ b \end{pmatrix} & = \begin{pmatrix} 9 \\ -4 \end{pmatrix}
\end{align*}
$$
and using properties of vector addition can be written as
$$
\begin{align*}
\begin{pmatrix} 3a - 2b \\ 6a + b \end{pmatrix} & = \begin{pmatrix} 9 \\ -4 \end{pmatrix}
\end{align*}
$$
Recognizing this as a system of linear equations
$$
\begin{align*}
3a - 2b & = 9 \\ 
6a + b & = -4,
\end{align*}
$$
the system of equations can be written in an augmented matrix form as
$$
\begin{align*}
\begin{pmatrix}
3  & - 2 & 9\\
6  &   1 & -4 
\end{pmatrix}
\end{align*}
$$
Reducing the augmented matrix to reduced row echelon form gives
```{r}
rref(matrix(c(3, 6, -2, 1, 9, -4), 2, 3))
```
which has solutions $a = 0.0667$ and $b = -4.4$.

* **Result:** Any vector equation $a_1 \mathbf{x}_1 + a_2 + \mathbf{x}_2 +  \ldots + a_K \mathbf{x}_K = \mathbf{c}$ for a given constant vector $\mathbf{b}$ has the same solution set as the augmented matrix

$$
\begin{align*}
\begin{pmatrix} \mathbf{x}_1 & \mathbf{x}_2 & \cdots & \mathbf{x}_K & \mathbf{b} \end{pmatrix}
\end{align*}
$$
Equivalently, the set of vectors $\{\mathbf{x}_k\}_{k=1}^K$ can only be combined with linear coefficients $\{a_k\}_{k=1}^K$ to equal the vector $\mathbf{b}$ if the linear system of equations is consistent.

### The geometric interpretation of linear combinations of vectors

Consider the vectors $\mathbf{u} = \begin{pmatrix} \sqrt{2} \\ - \sqrt{2} \end{pmatrix}$ and $\mathbf{v} = \begin{pmatrix} 1 \\ 1\end{pmatrix}$ shown in the figure below on the left.

```{r}
df <- data.frame(x = c(sqrt(2), 1), y = c(-sqrt(2), 1))
p1 <- ggplot() +
    geom_segment(aes(x = 0, xend = sqrt(2), y = 0, yend = -sqrt(2)), arrow = arrow(), color = "blue") +
    geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1), arrow = arrow(), color = "red") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4)) + 
    geom_polygon(data = df, aes(x = x, y = y), fill = "grey", alpha = 0.5) +
    ggtitle("u and v")
expand.grid(df)

p2 <- ggplot() +
    geom_segment(aes(x = 0, xend = -2, y = 0, yend = 1), arrow = arrow(), color = "red") +
    geom_segment(aes(x = -2, xend = -2 + 3, y = 1, yend = 1 + 2), arrow = arrow(), color = "blue") +
    geom_segment(aes(x = 0, xend = 3 - 2, y = 0, yend = 2 + 1), arrow = arrow(), color = "black") +
    geom_vline(xintercept = 0) + 
    geom_hline(yintercept = 0) +
    coord_cartesian(xlim = c(-4, 4), ylim = c(-4, 4)) +
    geom_polygon(data = df, aes(x = x, y = y), fill = "grey", alpha = 0.5) +
    ggtitle("v + u")
p1 + p2
```


